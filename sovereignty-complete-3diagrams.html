<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DApp Sovereignty Framework - Complete Analysis</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            font-size: 14px;
            line-height: 1.6;
            background: #0a0a0f;
            color: #e0e0ff;
            padding: 20px;
        }
        
        .container { max-width: 1600px; margin: 0 auto; }
        
        h1 {
            text-align: center;
            color: #00ffff;
            font-size: clamp(1.5rem, 4vw, 2.2rem);
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .subtitle {
            text-align: center;
            color: #8888aa;
            font-size: clamp(0.9rem, 2vw, 1.1rem);
            margin-bottom: 40px;
        }
        
        .nav-tabs {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .tab-button {
            background: rgba(0, 255, 255, 0.1);
            border: 2px solid #00ffff;
            color: #00ffff;
            padding: 12px 25px;
            font-family: inherit;
            font-size: 0.9rem;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .tab-button:hover {
            background: rgba(0, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .tab-button.active {
            background: #00ffff;
            color: #0a0a0f;
            font-weight: 700;
        }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .main-content {
            display: flex;
            gap: 30px;
            align-items: flex-start;
        }
        
        @media (max-width: 1200px) {
            .main-content { flex-direction: column; }
            .info-container { max-width: 100%; }
            .info-panel { position: relative !important; top: 0 !important; }
        }
        
        .diagram-container { flex: 1.4; min-width: 0; }
        .info-container { flex: 1; min-width: 300px; max-width: 550px; }
        
        .sovereignty-diagram {
            width: 100%;
            height: 750px;
            display: block;
        }
        
        .diagram-title {
            text-align: center;
            color: #00ffff;
            font-size: 1.6rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .diagram-subtitle {
            text-align: center;
            color: #8888aa;
            font-size: 0.95rem;
            margin-bottom: 25px;
        }
        
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 25px;
            justify-content: center;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.7rem;
        }
        
        .legend-color {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            border: 2px solid #fff;
            flex-shrink: 0;
        }
        
        .ring {
            cursor: pointer;
            transition: opacity 0.3s;
        }
        
        .ring:hover { opacity: 0.8; }
        
        .ring-label {
            font-size: clamp(11px, 1.5vw, 15px);
            font-weight: 700;
            fill: #e0e0ff;
            text-anchor: middle;
            pointer-events: none;
        }
        
        .sovereignty-score {
            font-size: clamp(12px, 1.8vw, 18px);
            font-weight: 700;
            fill: #00ffff;
            text-anchor: middle;
        }
        
        .info-panel {
            background: rgba(20, 20, 40, 0.9);
            border: 2px solid #00ffff;
            border-radius: 10px;
            padding: 20px;
            min-height: 750px;
            max-height: 750px;
            overflow-y: auto;
            position: sticky;
            top: 20px;
        }
        
        .info-panel:empty::before {
            content: "üëÜ Click any ring to view detailed analysis";
            color: #8888aa;
            font-style: italic;
            display: block;
            text-align: center;
            padding: 100px 20px;
            font-size: 1.1rem;
        }
        
        .info-panel h2 {
            color: #00ffff;
            margin-top: 0;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 15px;
        }
        
        .info-panel h3 {
            color: #00ffaa;
            font-size: 1rem;
            font-weight: 700;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .info-panel h4 {
            color: #ff6b6b;
            font-size: 0.95rem;
            font-weight: 700;
            margin-top: 10px;
            margin-bottom: 5px;
        }
        
        .info-panel p {
            margin: 10px 0;
            line-height: 1.7;
        }
        
        .info-panel ul {
            margin: 12px 0;
            padding-left: 20px;
        }
        
        .info-panel li {
            margin: 8px 0;
            line-height: 1.6;
        }
        
        .power-holder {
            background: rgba(255, 107, 107, 0.1);
            border-left: 3px solid #ff6b6b;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        
        .power-holder h4 {
            color: #ff6b6b;
            margin-top: 0;
        }
        
        .constraint { color: #ffaa00; font-weight: 600; }
        
        .info-section {
            background: rgba(0, 255, 255, 0.05);
            border-left: 3px solid #00ffff;
            padding: 12px;
            margin: 15px 0;
            border-radius: 5px;
        }
        
        .score-badge {
            display: inline-block;
            background: linear-gradient(135deg, #00ffff, #00aaff);
            color: #0a0a0f;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 1.1rem;
        }
        
        /* Calculator styles */
        .calculator-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .calculator-section {
            background: rgba(20, 20, 40, 0.6);
            border: 2px solid #00ffff;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
        }
        
        .calculator-section h3 {
            color: #00ffff;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .ring-number {
            background: #00ffff;
            color: #0a0a0f;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }
        
        .choice-group {
            margin: 20px 0;
        }
        
        .choice-label {
            display: block;
            margin-bottom: 8px;
            color: #8888aa;
            font-size: 0.9rem;
        }
        
        .choice-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .choice-option {
            background: rgba(0, 255, 255, 0.05);
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        
        .choice-option:hover {
            border-color: #00ffff;
            background: rgba(0, 255, 255, 0.1);
        }
        
        .choice-option.selected {
            border-color: #00ffff;
            background: rgba(0, 255, 255, 0.2);
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
        }
        
        .choice-radio {
            width: 20px;
            height: 20px;
            border: 2px solid #00ffff;
            border-radius: 50%;
            flex-shrink: 0;
            margin-top: 2px;
            position: relative;
        }
        
        .choice-option.selected .choice-radio::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 10px;
            height: 10px;
            background: #00ffff;
            border-radius: 50%;
        }
        
        .choice-content {
            flex: 1;
        }
        
        .choice-title {
            color: #e0e0ff;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .choice-description {
            color: #8888aa;
            font-size: 0.85rem;
            line-height: 1.5;
        }
        
        .choice-sovereignty {
            color: #00ffff;
            font-weight: 700;
            margin-top: 5px;
        }
        
        .results-panel {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.1), rgba(255, 0, 255, 0.1));
            border: 3px solid #00ffff;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
        }
        
        .results-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .final-score {
            font-size: 4rem;
            color: #00ffff;
            font-weight: 700;
            text-shadow: 0 0 30px rgba(0, 255, 255, 0.5);
        }
        
        .score-label {
            color: #8888aa;
            font-size: 1.2rem;
            margin-top: 10px;
        }
        
        .score-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .score-item {
            background: rgba(0, 0, 0, 0.3);
            border-left: 4px solid #00ffff;
            padding: 15px;
            border-radius: 8px;
        }
        
        .score-item-title {
            color: #00ffff;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }
        
        .score-item-value {
            font-size: 2rem;
            font-weight: 700;
        }
        
        .recommendations {
            background: rgba(255, 170, 0, 0.1);
            border: 2px solid #ffaa00;
            border-radius: 10px;
            padding: 20px;
            margin-top: 25px;
        }
        
        .recommendations h4 {
            color: #ffaa00;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .recommendation-item {
            background: rgba(0, 0, 0, 0.2);
            border-left: 3px solid #ffaa00;
            padding: 12px;
            margin: 12px 0;
            border-radius: 5px;
        }
        
        .recommendation-impact {
            color: #00ffff;
            font-weight: 700;
            margin-top: 5px;
        }
        
        .warning-box {
            background: rgba(255, 107, 107, 0.1);
            border: 2px solid #ff6b6b;
            border-radius: 10px;
            padding: 20px;
            margin-top: 25px;
        }
        
        .warning-box h4 {
            color: #ff6b6b;
            margin-top: 0;
        }
        
        .calculate-btn {
            background: linear-gradient(135deg, #00ffff, #00aaff);
            border: none;
            color: #0a0a0f;
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: 700;
            border-radius: 10px;
            cursor: pointer;
            display: block;
            margin: 30px auto;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.4);
        }
        
        .progress-bar {
            width: 100%;
            height: 30px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #ffaa00, #ffff00, #00ffaa, #00ffff);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 15px;
            font-weight: 700;
            color: #0a0a0f;
        }
        
        /* Trilemma Analyzer Styles */
        .trilemma-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .trilemma-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .trilemma-header h2 {
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            background: linear-gradient(135deg, #00ffff, #ff00ff, #00ffaa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .trilemma-header p {
            color: #8888aa;
            font-size: clamp(1rem, 2vw, 1.2rem);
        }
        
        .trilemma-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .trilemma-card {
            background: rgba(20, 20, 40, 0.6);
            border: 2px solid #00ffff;
            border-radius: 15px;
            padding: 25px;
        }
        
        .trilemma-card h3 {
            color: #00ffff;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.3rem;
            text-align: center;
        }
        
        .triangle-chart {
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
        }
        
        .triangle-svg {
            width: 100%;
            height: auto;
        }
        
        .architecture-card {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 15px;
        }
        
        .architecture-card:hover {
            border-color: #00ffff;
            background: rgba(0, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        
        .architecture-card.selected {
            border-color: #00ffff;
            background: rgba(0, 255, 255, 0.2);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }
        
        .architecture-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 10px;
            vertical-align: middle;
        }
        
        .architecture-name {
            font-weight: 700;
            color: #e0e0ff;
            margin-bottom: 5px;
        }
        
        .architecture-scores {
            font-size: 0.85rem;
            color: #8888aa;
        }
        
        .dimension-bar {
            margin: 15px 0;
        }
        
        .dimension-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-weight: 700;
        }
        
        .dimension-bar-bg {
            width: 100%;
            height: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .dimension-bar-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }
        
        .dimension-bar-fill.sovereignty {
            background: linear-gradient(90deg, #00ffff, #00aaff);
        }
        
        .dimension-bar-fill.persistence {
            background: linear-gradient(90deg, #00ffaa, #00aa88);
        }
        
        .dimension-bar-fill.practicality {
            background: linear-gradient(90deg, #ff00ff, #aa00aa);
        }
        
        .dimension-description {
            font-size: 0.8rem;
            color: #8888aa;
            margin-top: 3px;
        }
        
        .custom-builder {
            background: rgba(20, 20, 40, 0.6);
            border: 2px solid #00ffff;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
        }
        
        .custom-builder h3 {
            color: #00ffff;
            margin-top: 0;
            margin-bottom: 20px;
        }
        
        .slider-group {
            margin: 20px 0;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 700;
        }
        
        .slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: rgba(0, 0, 0, 0.3);
            outline: none;
            -webkit-appearance: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #00ffff;
            cursor: pointer;
        }
        
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #00ffff;
            cursor: pointer;
            border: none;
        }
        
        .total-score {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            text-align: center;
        }
        
        .total-score.valid {
            border: 2px solid #00ffaa;
        }
        
        .total-score.invalid {
            border: 2px solid #ff6b6b;
        }
        
        .insights-box {
            background: rgba(20, 20, 40, 0.6);
            border: 2px solid #00ffff;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
        }
        
        .insights-box h3 {
            color: #00ffff;
            margin-top: 0;
            margin-bottom: 20px;
        }
        
        .insight-item {
            display: flex;
            gap: 15px;
            margin: 15px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            border-left: 3px solid #00ffff;
        }
        
        .insight-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåê DApp Sovereignty Framework</h1>
        <p class="subtitle">Comprehensive Analysis: User + Developer = Overall DApp Sovereignty</p>
        
        <div class="nav-tabs">
            <button class="tab-button active" onclick="switchTab('user')">
                üë• User Sovereignty
            </button>
            <button class="tab-button" onclick="switchTab('developer')">
                üë®‚Äçüíª Developer Sovereignty
            </button>
            <button class="tab-button" onclick="switchTab('overall')">
                üéØ Overall DApp
            </button>
            <button class="tab-button" onclick="switchTab('calculator')">
                üßÆ DApp Calculator
            </button>
            <button class="tab-button" onclick="switchTab('trilemma')">
                ‚öñÔ∏è Storage Trilemma
            </button>
        </div>
        
        <!-- USER SOVEREIGNTY TAB -->
        <div id="user-tab" class="tab-content active">
            <div class="main-content">
                <div class="diagram-container">
                    <h2 class="diagram-title">üë• User Sovereignty</h2>
                    <p class="diagram-subtitle">How much control do end-users have over their data?</p>
                    
                    <div class="legend">
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(255, 107, 107, 0.3);"></div>
                            <span>Ring 1: Physical (40%)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(255, 170, 0, 0.3);"></div>
                            <span>Ring 2: Network (50%)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(255, 255, 0, 0.3);"></div>
                            <span>Ring 3: Protocol (70%)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(0, 255, 170, 0.3);"></div>
                            <span>Ring 4: Platform (85%)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(0, 255, 255, 0.3);"></div>
                            <span>Ring 5: Cryptographic (90%)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(0, 170, 255, 0.7);"></div>
                            <span>User Agency: 40%</span>
                        </div>
                    </div>
                    
                    <svg id="user-diagram" class="sovereignty-diagram" viewBox="0 0 1000 1000"></svg>
                </div>
                
                <div class="info-container">
                    <div id="user-panel" class="info-panel"></div>
                </div>
            </div>
        </div>
        
        <!-- DEVELOPER SOVEREIGNTY TAB -->
        <div id="developer-tab" class="tab-content">
            <div class="main-content">
                <div class="diagram-container">
                    <h2 class="diagram-title">üë®‚Äçüíª Developer Sovereignty</h2>
                    <p class="diagram-subtitle">How much control do YOU have over your DApp infrastructure?</p>
                    
                    <div class="legend">
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(255, 107, 107, 0.3);"></div>
                            <span>Ring 1: Physical (15%)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(255, 170, 0, 0.3);"></div>
                            <span>Ring 2: Network (10%)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(255, 255, 0, 0.3);"></div>
                            <span>Ring 3: Protocol (70%)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(0, 255, 170, 0.3);"></div>
                            <span>Ring 4: Platform (15%)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(0, 255, 255, 0.3);"></div>
                            <span>Ring 5: Cryptographic (20%)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(0, 170, 255, 0.7);"></div>
                            <span>DApp Agency: 10%</span>
                        </div>
                    </div>
                    
                    <svg id="developer-diagram" class="sovereignty-diagram" viewBox="0 0 1000 1000"></svg>
                </div>
                
                <div class="info-container">
                    <div id="developer-panel" class="info-panel"></div>
                </div>
            </div>
        </div>
        
        <!-- OVERALL SOVEREIGNTY TAB -->
        <div id="overall-tab" class="tab-content">
            <div class="main-content">
                <div class="diagram-container">
                    <h2 class="diagram-title">üéØ Overall DApp Sovereignty</h2>
                    <p class="diagram-subtitle">MIN(User, Developer) = Combined Sovereignty</p>
                    
                    <div class="legend">
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(255, 107, 107, 0.3);"></div>
                            <span>Ring 1: Physical (15%)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(255, 170, 0, 0.3);"></div>
                            <span>Ring 2: Network (10%)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(255, 255, 0, 0.3);"></div>
                            <span>Ring 3: Protocol (70%)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(0, 255, 170, 0.3);"></div>
                            <span>Ring 4: Platform (15%)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(0, 255, 255, 0.3);"></div>
                            <span>Ring 5: Cryptographic (20%)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: rgba(0, 170, 255, 0.7);"></div>
                            <span>Overall: 10%</span>
                        </div>
                    </div>
                    
                    <svg id="overall-diagram" class="sovereignty-diagram" viewBox="0 0 1000 1000"></svg>
                </div>
                
                <div class="info-container">
                    <div id="overall-panel" class="info-panel"></div>
                </div>
            </div>
        </div>
        
        <!-- CALCULATOR TAB -->
        <div id="calculator-tab" class="tab-content">
            <div class="calculator-container">
                <p style="text-align: center; color: #8888aa; margin-bottom: 30px;">
                    Select your implementation choices for each sovereignty layer.<br>
                    The calculator will show your final user sovereignty score and recommendations.
                </p>
                
                <!-- Ring 4: Platform -->
                <div class="calculator-section">
                    <h3>
                        <span class="ring-number">4</span>
                        Platform Sovereignty: Storage Identity Model
                    </h3>
                    <div class="choice-group">
                        <label class="choice-label">How do users store data in your DApp?</label>
                        <div class="choice-options">
                            <div class="choice-option" data-ring="4" data-value="20" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">API Key Model (Lighthouse Default)</div>
                                    <div class="choice-description">
                                        All users share YOUR API key. Data uploaded to YOUR account.
                                        Users have no independent identity or namespace.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 20%</div>
                                </div>
                            </div>
                            
                            <div class="choice-option" data-ring="4" data-value="50" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">Platform Accounts</div>
                                    <div class="choice-description">
                                        Users create accounts on your platform. Data tied to platform identity.
                                        Export possible but limited portability.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 50%</div>
                                </div>
                            </div>
                            
                            <div class="choice-option" data-ring="4" data-value="70" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">UCAN Identity (Storacha)</div>
                                    <div class="choice-description">
                                        Users authenticate with their wallet/keypair. Data namespace owned by user.
                                        Can access from other UCAN-compatible apps.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 70%</div>
                                </div>
                            </div>
                            
                            <div class="choice-option" data-ring="4" data-value="85" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">UCAN + On-Chain Registry</div>
                                    <div class="choice-description">
                                        UCAN identity PLUS user deploys their own smart contract to record CIDs.
                                        Full ownership proof on-chain. Maximum portability.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 85%</div>
                                </div>
                            </div>
                            
                            <div class="choice-option" data-ring="4" data-value="95" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">Direct Filecoin Contracts</div>
                                    <div class="choice-description">
                                        Users propose storage deals directly via smart contracts (FRC-0068).
                                        No platform intermediary. Maximum sovereignty but high complexity.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 95%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Ring 4b: Economic -->
                <div class="calculator-section">
                    <h3>
                        <span class="ring-number">4</span>
                        Economic Sovereignty: Payment Model
                    </h3>
                    <div class="choice-group">
                        <label class="choice-label">Who pays for storage and how?</label>
                        <div class="choice-options">
                            <div class="choice-option" data-ring="4b" data-value="10" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">Free for Users (You Pay)</div>
                                    <div class="choice-description">
                                        You subsidize all storage costs. Users pay nothing.
                                        Complete economic dependency on your business model.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 10%</div>
                                </div>
                            </div>
                            
                            <div class="choice-option" data-ring="4b" data-value="40" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">Subscription Through You</div>
                                    <div class="choice-description">
                                        Users pay you subscription fees. You pay storage provider.
                                        Users depend on your continued service.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 40%</div>
                                </div>
                            </div>
                            
                            <div class="choice-option" data-ring="4b" data-value="70" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">Direct Payment to Provider (Storacha Subscription)</div>
                                    <div class="choice-description">
                                        Users create own account and pay Storacha/provider directly.
                                        Economic relationship between user and provider.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 70%</div>
                                </div>
                            </div>
                            
                            <div class="choice-option" data-ring="4b" data-value="85" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">Perpetual Payment (Lighthouse)</div>
                                    <div class="choice-description">
                                        User pays once from wallet for lifetime storage.
                                        No recurring payments. Managed by smart contracts.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 85%</div>
                                </div>
                            </div>
                            
                            <div class="choice-option" data-ring="4b" data-value="95" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">Direct Filecoin Deal Payment</div>
                                    <div class="choice-description">
                                        User pays storage providers directly via smart contracts.
                                        User negotiates terms and manages deals. Maximum autonomy.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 95%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Ring 4c: Infrastructure -->
                <div class="calculator-section">
                    <h3>
                        <span class="ring-number">4</span>
                        Infrastructure Sovereignty: Storage Infrastructure & Self-Hosting
                    </h3>
                    <div class="choice-group">
                        <label class="choice-label">Where is data stored and who controls the infrastructure?</label>
                        <div class="choice-options">
                            <div class="choice-option" data-ring="4c" data-value="15" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">Single Provider, Single Jurisdiction</div>
                                    <div class="choice-description">
                                        All data stored with one storage provider in one country/jurisdiction.
                                        High risk of single point of failure and jurisdictional control.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 15%</div>
                                </div>
                            </div>
                            
                            <div class="choice-option" data-ring="4c" data-value="40" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">Multiple Providers, Same Jurisdiction</div>
                                    <div class="choice-description">
                                        Data distributed across multiple storage providers, but all in same legal jurisdiction.
                                        Reduces single provider risk but still vulnerable to jurisdiction-level actions.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 40%</div>
                                </div>
                            </div>
                            
                            <div class="choice-option" data-ring="4c" data-value="60" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">Multiple Providers, Multiple Jurisdictions</div>
                                    <div class="choice-description">
                                        Data distributed across providers in different countries/jurisdictions.
                                        Better resilience but still dependent on third-party providers.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 60%</div>
                                </div>
                            </div>
                            
                            <div class="choice-option" data-ring="4c" data-value="75" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">User-Selectable Providers</div>
                                    <div class="choice-description">
                                        Users can choose which storage providers to use from a decentralized network.
                                        Users have control over provider selection but still rely on third parties.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 75%</div>
                                </div>
                            </div>
                            
                            <div class="choice-option" data-ring="4c" data-value="85" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">Self-Hosted IPFS Node</div>
                                    <div class="choice-description">
                                        Users run their own IPFS node to pin and serve their data.
                                        Full control over infrastructure, but requires technical knowledge and maintenance.
                                        Data redundancy depends on other nodes pinning.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 85%</div>
                                </div>
                            </div>
                            
                            <div class="choice-option" data-ring="4c" data-value="95" onclick="selectChoice(this)">
                                <div class="choice-radio"></div>
                                <div class="choice-content">
                                    <div class="choice-title">Self-Hosted IPFS Cluster</div>
                                    <div class="choice-description">
                                        Users run their own IPFS Cluster (multiple IPFS nodes) for redundancy and high availability.
                                        Maximum infrastructure sovereignty: full control, geographic distribution, no third-party dependency.
                                        Users own and operate their complete storage infrastructure.
                                    </div>
                                    <div class="choice-sovereignty">Sovereignty: 95%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button class="calculate-btn" onclick="calculateSovereignty()">
                    Calculate Sovereignty Score
                </button>
                
                <div id="results" style="display: none;">
                    <div class="results-panel">
                        <div class="results-header">
                            <div class="final-score" id="final-score">--</div>
                            <div class="score-label">User Sovereignty Score</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="progress-fill" style="width: 0%;">
                                    <span id="progress-text"></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="score-breakdown" id="score-breakdown">
                            <!-- Breakdown will be inserted here -->
                        </div>
                        
                        <div class="warning-box">
                            <h4>‚ö†Ô∏è Outer Ring Constraints (Cannot Be Changed)</h4>
                            <p><strong>Ring 1 (Physical):</strong> 40% - Filecoin distributed storage providers globally. Limited by nation-state jurisdiction.</p>
                            <p><strong>Ring 2 (Network):</strong> 50% - libp2p peer-to-peer overlay. Limited by ISP control and national firewalls.</p>
                            <p><strong>Ring 3 (Protocol):</strong> 70% - Open IPFS/Filecoin protocols. Limited by Protocol Labs coordination.</p>
                            <p style="margin-top: 15px; color: #ffaa00;"><strong>Your final score is MIN(outer rings, your choices)</strong></p>
                        </div>
                        
                        <div class="recommendations" id="recommendations">
                            <!-- Recommendations will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- TRILEMMA ANALYZER TAB -->
        <div id="trilemma-tab" class="tab-content">
            <div class="trilemma-container">
                <div class="trilemma-header">
                    <h2>Decentralized Storage Trilemma</h2>
                    <p>You cannot maximize all three: pick two, sacrifice one</p>
                </div>
                
                <!-- Narrative Explanation -->
                <div class="trilemma-card" style="margin-bottom: 30px; max-width: 1000px; margin-left: auto; margin-right: auto;">
                    <h3 style="color: #00ffff; margin-top: 0; text-align: center; font-size: 1.5rem;">Understanding the Trilemma</h3>
                    
                    <div style="line-height: 1.8; color: #e0e0ff;">
                        <p style="font-size: 1.1rem; margin-bottom: 20px;">
                            Imagine you're building a system to store data. You want three things: <strong style="color: #00ffff;">control</strong>, <strong style="color: #00ffaa;">reliability</strong>, and <strong style="color: #ff00ff;">ease of use</strong>. The harsh truth? <strong style="color: #ffaa00;">You can't have all three at maximum levels.</strong>
                        </p>
                        
                        <div style="background: rgba(0, 255, 255, 0.1); border-left: 4px solid #00ffff; padding: 20px; margin: 25px 0; border-radius: 8px;">
                            <h4 style="color: #00ffff; margin-top: 0; font-size: 1.2rem; margin-bottom: 15px;">The Three Dimensions</h4>
                            
                            <div style="margin-bottom: 20px;">
                                <p style="margin-bottom: 10px;">
                                    <strong style="color: #00ffff;">1. Sovereignty (Control)</strong> ‚Äî How much do you actually control your infrastructure? Can someone else shut you down? Are you dependent on a service that could disappear tomorrow? Maximum sovereignty means you run everything yourself‚Äîno intermediaries, no trusted third parties, no single points of failure.
                                </p>
                                <p style="font-size: 0.9rem; color: #8888aa; margin-left: 20px;">
                                    Think: Running your own server vs. using Dropbox. One gives you control, the other gives you convenience.
                                </p>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <p style="margin-bottom: 10px;">
                                    <strong style="color: #00ffaa;">2. Persistence (Reliability)</strong> ‚Äî Will your data still be there in a year? In ten years? Do you have guarantees, proofs, or just hope? Maximum persistence means cryptographic proofs, economic incentives, redundancy across multiple independent parties‚Äîsystems designed to survive even if individual components fail.
                                </p>
                                <p style="font-size: 0.9rem; color: #8888aa; margin-left: 20px;">
                                    Think: Filecoin's cryptographic storage proofs vs. asking your friend to keep a backup. One has guarantees, the other has trust.
                                </p>
                            </div>
                            
                            <div>
                                <p style="margin-bottom: 10px;">
                                    <strong style="color: #ff00ff;">3. Practicality (Ease of Use)</strong> ‚Äî Can a normal person use this? How much technical knowledge is required? How long does setup take? Maximum practicality means one-click solutions, zero maintenance, works out of the box‚Äîthe kind of experience people expect from modern apps.
                                </p>
                                <p style="font-size: 0.9rem; color: #8888aa; margin-left: 20px;">
                                    Think: Clicking "Upload to Dropbox" vs. configuring an IPFS node, managing keys, and maintaining infrastructure.
                                </p>
                            </div>
                        </div>
                        
                        <div style="background: rgba(255, 170, 0, 0.1); border-left: 4px solid #ffaa00; padding: 20px; margin: 25px 0; border-radius: 8px;">
                            <h4 style="color: #ffaa00; margin-top: 0; font-size: 1.2rem; margin-bottom: 15px;">Why You Can't Have It All</h4>
                            
                            <p style="margin-bottom: 15px;">
                                Here's the fundamental constraint: <strong>These three dimensions are in tension with each other.</strong>
                            </p>
                            
                            <p style="margin-bottom: 15px;">
                                Want <strong style="color: #00ffff;">maximum sovereignty</strong>? You need to run your own infrastructure. That means technical complexity, maintenance overhead, and accepting responsibility. <strong style="color: #ff00ff;">Practicality suffers.</strong>
                            </p>
                            
                            <p style="margin-bottom: 15px;">
                                Want <strong style="color: #00ffaa;">guaranteed persistence</strong>? You need cryptographic proofs, economic incentives, redundancy systems. That means complex protocols, payment infrastructure, and coordination mechanisms. <strong style="color: #ff00ff;">Practicality suffers.</strong>
                            </p>
                            
                            <p style="margin-bottom: 15px;">
                                Want <strong style="color: #ff00ff;">maximum practicality</strong>? You need abstraction layers, managed services, "it just works" experiences. That means trusting third parties, accepting vendor lock-in, and giving up control. <strong style="color: #00ffff;">Sovereignty suffers.</strong>
                            </p>
                            
                            <p style="font-size: 1.05rem; color: #ffaa00; font-weight: 700; margin-top: 20px;">
                                The trilemma forces you to choose: Which two matter most? What are you willing to sacrifice?
                            </p>
                        </div>
                        
                        <div style="background: rgba(0, 255, 170, 0.1); border-left: 4px solid #00ffaa; padding: 20px; margin: 25px 0; border-radius: 8px;">
                            <h4 style="color: #00ffaa; margin-top: 0; font-size: 1.2rem; margin-bottom: 15px;">Real-World Examples</h4>
                            
                            <div style="margin-bottom: 20px;">
                                <p style="margin-bottom: 8px;">
                                    <strong>Dropbox (Persistence + Practicality, Sacrifice Sovereignty)</strong>
                                </p>
                                <p style="font-size: 0.95rem; color: #8888aa; margin-left: 20px;">
                                    Easy to use? Absolutely. Reliable? Yes, with SLAs and guarantees. But you're trusting a company, subject to their terms of service, vulnerable to censorship, and locked into their platform. Sovereignty: 5%.
                                </p>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <p style="margin-bottom: 8px;">
                                    <strong>Lighthouse (API Key Model) - Persistence + Practicality, Sacrifice Sovereignty</strong>
                                </p>
                                <p style="font-size: 0.95rem; color: #8888aa; margin-left: 20px;">
                                    All users share YOUR API key. Data uploaded to YOUR account. Users have no independent identity. Very easy to use, decent persistence through Filecoin, but sovereignty is extremely low. If Lighthouse shuts down, users lose everything. Sovereignty: 20%.
                                </p>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <p style="margin-bottom: 8px;">
                                    <strong>Storacha/Web3.Storage (UCAN) - Persistence + Practicality, Sacrifice Sovereignty</strong>
                                </p>
                                <p style="font-size: 0.95rem; color: #8888aa; margin-left: 20px;">
                                    Uses UCAN identity‚Äîbetter than API keys! Users own their namespace. But you're still using their API, their service, their infrastructure. If they shut down, you lose access. The "decentralization" is hidden behind a centralized interface. Sovereignty: 30%.
                                </p>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <p style="margin-bottom: 8px;">
                                    <strong>Direct Lotus API - Persistence + Some Sovereignty, Sacrifice Practicality</strong>
                                </p>
                                <p style="font-size: 0.95rem; color: #8888aa; margin-left: 20px;">
                                    More control than services, cryptographic guarantees, but still uses centralized Lotus endpoints. Complex setup, medium sovereignty ceiling. Sovereignty: 40%.
                                </p>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <p style="margin-bottom: 8px;">
                                    <strong>Direct Filecoin Deals (FRC-0068) - Persistence + Sovereignty, Sacrifice Practicality</strong>
                                </p>
                                <p style="font-size: 0.95rem; color: #8888aa; margin-left: 20px;">
                                    Users propose storage deals directly via smart contracts. No platform intermediary. Maximum autonomy, cryptographic proofs, but extremely high complexity. Users negotiate terms and manage deals themselves. Sovereignty: 50%, Practicality: 25%.
                                </p>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <p style="margin-bottom: 8px;">
                                    <strong>Self-Hosted IPFS Node (Solo) - Sovereignty + Practicality, Sacrifice Persistence</strong>
                                </p>
                                <p style="font-size: 0.95rem; color: #8888aa; margin-left: 20px;">
                                    User runs single IPFS node. Full infrastructure control, reasonable setup complexity. But no redundancy‚Äîdata persists only while node is running. Single point of failure. Sovereignty: 85%, Persistence: 20%.
                                </p>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <p style="margin-bottom: 8px;">
                                    <strong style="color: #00ffff;">Self-Hosted IPFS Cluster - Maximum Sovereignty + Some Persistence, Moderate Practicality</strong>
                                </p>
                                <p style="font-size: 0.95rem; color: #8888aa; margin-left: 20px;">
                                    User runs multiple IPFS nodes (cluster) for redundancy and high availability. Maximum infrastructure sovereignty with geographic distribution. No third-party dependency. Users own and operate complete storage infrastructure. Still user-responsible but with redundancy. Sovereignty: 95%, Persistence: 60%, Practicality: 45%. <strong style="color: #00ffff;">This is the maximum practical infrastructure sovereignty.</strong>
                                </p>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <p style="margin-bottom: 8px;">
                                    <strong>Self-Hosted IPFS + Filecoin Node - Sovereignty + Persistence, Sacrifice Practicality</strong>
                                </p>
                                <p style="font-size: 0.95rem; color: #8888aa; margin-left: 20px;">
                                    You control the infrastructure. You get cryptographic storage proofs. But you need 1TB+ storage, days of syncing, technical expertise, and ongoing maintenance. Most users can't do this. Practicality: 15%.
                                </p>
                            </div>
                            
                            <div>
                                <p style="margin-bottom: 8px;">
                                    <strong style="color: #00ffff;">Mutual IPFS Pinning Network - Sovereignty + Practicality, Sacrifice Persistence</strong>
                                </p>
                                <p style="font-size: 0.95rem; color: #8888aa; margin-left: 20px;">
                                    Users run lightweight IPFS nodes, voluntarily pin each other's content. No centralized service. Censorship-resistant. Reasonable setup complexity. But there are no guarantees‚Äîdata persists only as long as someone pins it. No cryptographic proofs. No economic incentives. Persistence: 40%. <strong style="color: #00ffff;">This is the honest tradeoff: sovereignty requires responsibility.</strong>
                                </p>
                            </div>
                        </div>
                        
                        <div style="background: rgba(255, 107, 107, 0.1); border-left: 4px solid #ff6b6b; padding: 20px; margin: 25px 0; border-radius: 8px;">
                            <h4 style="color: #ff6b6b; margin-top: 0; font-size: 1.2rem; margin-bottom: 15px;">The Honesty Principle</h4>
                            
                            <p style="margin-bottom: 15px;">
                                Many "decentralized" services lie by omission. They market themselves as decentralized while using centralized APIs. They promise "guaranteed storage" through services you depend on. They create the illusion of sovereignty without the substance.
                            </p>
                            
                            <p style="margin-bottom: 15px;">
                                The trilemma framework forces honesty: <strong>If you want true sovereignty, you must accept responsibility.</strong> If you want guarantees, you must accept complexity or dependency. If you want convenience, you must accept that someone else has control.
                            </p>
                            
                            <p style="font-size: 1.05rem; color: #00ffff; font-weight: 700; margin-top: 20px;">
                                The mutual IPFS pinning network doesn't compromise‚Äîit makes the philosophically honest choice: maximize sovereignty and maintain reasonable practicality by explicitly placing persistence responsibility on users themselves.
                            </p>
                            
                            <p style="font-size: 0.95rem; color: #8888aa; margin-top: 15px; font-style: italic;">
                                This is not a bug‚Äîit's the honest architecture. Users who want control must accept that they are responsible for keeping their nodes running, that data persists only as long as someone pins it, and that there are no service provider guarantees. In exchange, they get actual sovereignty‚Äînot the illusion of it.
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="trilemma-grid">
                    <!-- Triangle Visualization -->
                    <div class="trilemma-card">
                        <h3 id="selected-arch-name">Mutual IPFS Pinning Network</h3>
                        <div class="triangle-chart">
                            <svg id="triangle-svg" class="triangle-svg" viewBox="-60 -60 520 520"></svg>
                        </div>
                        <div style="margin-top: 20px; padding: 15px; background: rgba(0, 0, 0, 0.3); border-radius: 8px;">
                            <p id="selected-arch-description" style="font-size: 0.9rem; color: #8888aa; margin: 0;">
                                High sovereignty, social persistence, moderate setup
                            </p>
                            <div style="margin-top: 10px; font-size: 0.85rem; color: #00ffff;">
                                Position: <span id="trilemma-position">Sovereignty + Practicality</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Dimension Scores -->
                    <div class="trilemma-card">
                        <h3>Dimension Scores</h3>
                        <div class="dimension-bar">
                            <div class="dimension-label">
                                <span style="color: #00ffff;">Sovereignty</span>
                                <span id="sov-score">90%</span>
                            </div>
                            <div class="dimension-bar-bg">
                                <div id="sov-bar" class="dimension-bar-fill sovereignty" style="width: 90%;"></div>
                            </div>
                            <div class="dimension-description">User control, censorship resistance</div>
                        </div>
                        
                        <div class="dimension-bar">
                            <div class="dimension-label">
                                <span style="color: #00ffaa;">Persistence</span>
                                <span id="per-score">40%</span>
                            </div>
                            <div class="dimension-bar-bg">
                                <div id="per-bar" class="dimension-bar-fill persistence" style="width: 40%;"></div>
                            </div>
                            <div class="dimension-description">Durability guarantees, redundancy</div>
                        </div>
                        
                        <div class="dimension-bar">
                            <div class="dimension-label">
                                <span style="color: #ff00ff;">Practicality</span>
                                <span id="pra-score">60%</span>
                            </div>
                            <div class="dimension-bar-bg">
                                <div id="pra-bar" class="dimension-bar-fill practicality" style="width: 60%;"></div>
                            </div>
                            <div class="dimension-description">Ease of use, setup complexity</div>
                        </div>
                        
                        <div style="margin-top: 25px; padding: 15px; background: rgba(0, 0, 0, 0.3); border-radius: 8px; border: 1px solid rgba(0, 255, 255, 0.3);">
                            <h4 style="color: #00ffff; margin-top: 0; font-size: 0.9rem; margin-bottom: 10px;">Trilemma Constraint Analysis</h4>
                            <div style="font-size: 0.85rem; color: #e0e0ff;">
                                Total Score: <span id="total-score" style="color: #00ffff; font-weight: 700;">190</span> / 200 theoretical max
                            </div>
                            <div style="font-size: 0.75rem; color: #8888aa; margin-top: 8px;">
                                ‚ö†Ô∏è Scores totaling &gt;200 would violate the trilemma constraint
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Architecture Selector -->
                <div class="trilemma-card" style="margin-bottom: 30px;">
                    <h3>Compare Architectures</h3>
                    <div id="architecture-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        <!-- Architectures will be inserted here -->
                    </div>
                </div>
                
                <!-- Custom Builder -->
                <div class="custom-builder">
                    <h3>Build Custom Architecture</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; align-items: start;">
                        <div>
                            <div class="slider-group">
                                <div class="slider-label">
                                    <span style="color: #00ffff;">Sovereignty</span>
                                    <span id="custom-sov">50%</span>
                                </div>
                                <input type="range" min="0" max="100" value="50" id="sov-slider" class="slider" oninput="updateCustomArch()">
                            </div>
                            
                            <div class="slider-group">
                                <div class="slider-label">
                                    <span style="color: #00ffaa;">Persistence</span>
                                    <span id="custom-per">50%</span>
                                </div>
                                <input type="range" min="0" max="100" value="50" id="per-slider" class="slider" oninput="updateCustomArch()">
                            </div>
                            
                            <div class="slider-group">
                                <div class="slider-label">
                                    <span style="color: #ff00ff;">Practicality</span>
                                    <span id="custom-pra">50%</span>
                                </div>
                                <input type="range" min="0" max="100" value="50" id="pra-slider" class="slider" oninput="updateCustomArch()">
                            </div>
                            
                            <button onclick="visualizeCustom()" style="width: 100%; background: linear-gradient(135deg, #00ffff, #00aaff); border: none; color: #0a0a0f; padding: 12px; font-weight: 700; border-radius: 8px; cursor: pointer; margin-top: 15px; transition: all 0.3s;">
                                Visualize Custom Architecture
                            </button>
                            
                            <div id="custom-total" class="total-score valid" style="margin-top: 20px;">
                                <div style="color: #e0e0ff;">
                                    Total: <span id="custom-total-value" style="font-weight: 700; color: #00ffaa;">150</span> / 200
                                </div>
                                <div id="custom-warning" style="font-size: 0.75rem; color: #ff6b6b; margin-top: 8px; display: none;">
                                    ‚ö†Ô∏è This violates the trilemma constraint - impossible to achieve in practice
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <div class="triangle-chart">
                                <svg id="custom-triangle-svg" class="triangle-svg" viewBox="-60 -60 520 520"></svg>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Key Insights -->
                <div class="insights-box">
                    <h3>Key Insights</h3>
                    <div class="insight-item">
                        <span class="insight-icon" style="color: #00ffff;">‚Üí</span>
                        <p><strong>No perfect solution exists.</strong> Every architecture makes explicit tradeoffs.</p>
                    </div>
                    <div class="insight-item">
                        <span class="insight-icon" style="color: #00ffaa;">‚Üí</span>
                        <p><strong>Mutual IPFS pinning</strong> (90% sovereignty, 40% persistence, 60% practicality) represents an honest choice: maximize user control by placing persistence responsibility on users themselves.</p>
                    </div>
                    <div class="insight-item">
                        <span class="insight-icon" style="color: #ff00ff;">‚Üí</span>
                        <p><strong>Traditional services</strong> sacrifice sovereignty for convenience‚Äîbut so does direct Lotus API usage (centralized endpoint).</p>
                    </div>
                    <div class="insight-item">
                        <span class="insight-icon" style="color: #ffaa00;">‚Üí</span>
                        <p><strong>True sovereignty requires user responsibility.</strong> If you want control, you must maintain your own infrastructure.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        function switchTab(tabName) {
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Initialize trilemma when tab is shown
            if (tabName === 'trilemma') {
                setTimeout(initTrilemma, 100);
            }
        }
        
        // USER SOVEREIGNTY DATA
        const USER_DATA = {
            ring1: {
                name: "PHYSICAL SOVEREIGNTY",
                radius: 450,
                color: "rgba(255, 107, 107, 0.3)",
                strokeColor: "#ff6b6b",
                sovereignty: 40,
                powerHolders: [
                    {
                        name: "Nation States",
                        power: "Physical territory, law enforcement, military",
                        constraint: "Can seize servers, arrest operators, force shutdowns",
                        resistance: "Very High - Nearly impossible for individuals"
                    },
                    {
                        name: "Data Center Operators",
                        power: "Physical access to hardware, power supply",
                        constraint: "Can unplug servers, deny service, inspect hardware",
                        resistance: "High - Requires distributed infrastructure"
                    },
                    {
                        name: "Hardware Manufacturers",
                        power: "Supply chain, backdoors, design flaws",
                        constraint: "Can embed surveillance, create kill switches",
                        resistance: "High - Requires hardware diversity"
                    }
                ],
                currentPower: "20 countries control most infrastructure ‚Ä¢ Top 10 data center companies = 70% capacity",
                decentralization: "Filecoin: ~3,000+ storage providers globally ‚Ä¢ Bitcoin: ~15,000 nodes",
                implication: "If a nation state can physically seize servers, all other sovereignty becomes irrelevant"
            },
            ring2: {
                name: "NETWORK SOVEREIGNTY",
                radius: 360,
                color: "rgba(255, 170, 0, 0.3)",
                strokeColor: "#ffaa00",
                sovereignty: 50,
                powerHolders: [
                    {
                        name: "ICANN",
                        power: "Root DNS, domain names, IP allocation",
                        constraint: "Can revoke domains, control naming system",
                        resistance: "Very High - Global monopoly"
                    },
                    {
                        name: "Regional Internet Registries",
                        power: "IP address allocation (ARIN, RIPE, APNIC, etc.)",
                        constraint: "Control who gets IP blocks",
                        resistance: "Very High - Required for routing"
                    },
                    {
                        name: "Tier 1 ISPs",
                        power: "BGP routing, backbone infrastructure",
                        constraint: "Can blackhole routes, drop traffic",
                        resistance: "Very High - Control internet paths"
                    },
                    {
                        name: "National ISPs",
                        power: "Last-mile connectivity, DNS resolvers",
                        constraint: "Can block sites, inspect traffic, throttle",
                        resistance: "High - Can be bypassed with VPN/Tor"
                    }
                ],
                currentPower: "ICANN controls DNS root ‚Ä¢ 5 RIRs control IP allocation ‚Ä¢ ~15 Tier 1 ISPs control backbone",
                decentralization: "libp2p: Overlay network ‚Ä¢ Tor: Onion routing ‚Ä¢ ENS: Decentralized naming",
                implication: "If ISP blocks IPFS ports or country operates firewall, protocol sovereignty is constrained"
            },
            ring3: {
                name: "PROTOCOL SOVEREIGNTY",
                radius: 270,
                color: "rgba(255, 255, 0, 0.3)",
                strokeColor: "#ffff00",
                sovereignty: 70,
                powerHolders: [
                    {
                        name: "Protocol Labs",
                        power: "IPFS/Filecoin development, reference implementations",
                        constraint: "Can push protocol changes, coordinate upgrades",
                        resistance: "Medium - Open source, can be forked"
                    },
                    {
                        name: "Filecoin Foundation",
                        power: "Network governance, grants, ecosystem direction",
                        constraint: "Can influence protocol development",
                        resistance: "Medium - Community can resist"
                    },
                    {
                        name: "Storage Provider Cartels",
                        power: "Can refuse protocol upgrades, coordinate behavior",
                        constraint: "Can fragment network, refuse to serve",
                        resistance: "Medium - Market competition helps"
                    }
                ],
                currentPower: "Protocol Labs: Core dev ‚Ä¢ Filecoin Foundation: Governance ‚Ä¢ Large SPs: Economic influence",
                decentralization: "Open-source code ‚Ä¢ FIP process ‚Ä¢ Multiple implementations ‚Ä¢ Cryptographic proofs",
                implication: "If protocol adds censorship or KYC, platform-level sovereignty is constrained"
            },
            ring4: {
                name: "PLATFORM SOVEREIGNTY",
                radius: 180,
                color: "rgba(0, 255, 170, 0.3)",
                strokeColor: "#00ffaa",
                sovereignty: 85,
                powerHolders: [
                    {
                        name: "Lighthouse",
                        power: "API keys, gateway infrastructure, deal aggregation",
                        constraint: "Can shut down service, change pricing, alter features",
                        resistance: "Medium-High - Service dependency"
                    },
                    {
                        name: "Storacha (web3.storage)",
                        power: "Hosting infrastructure, UCAN services, gateway",
                        constraint: "Can terminate service, change ToS, alter features",
                        resistance: "Medium - Better than API key model"
                    },
                    {
                        name: "Storage Providers",
                        power: "Physical infrastructure, geographic location, jurisdiction",
                        constraint: "Can terminate service, change pricing, be seized by authorities",
                        resistance: "Medium - Can switch providers, but dependency remains"
                    },
                    {
                        name: "Third-Party Infrastructure",
                        power: "Control over where data is stored and who operates nodes",
                        constraint: "Single point of failure, jurisdictional risk, provider lock-in",
                        resistance: "High - Requires self-hosting to eliminate"
                    },
                    {
                        name: "Public IPFS Gateways",
                        power: "HTTP access to IPFS network",
                        constraint: "Can go offline, block content, rate limit",
                        resistance: "Medium - Multiple alternatives exist"
                    },
                    {
                        name: "Your DApp",
                        power: "User interface, convenience features, documentation",
                        constraint: "Can shut down, change features, require updates",
                        resistance: "Low - User can bypass if Ring 5 is strong"
                    }
                ],
                currentPower: "Ring 4 has THREE dimensions: (1) Identity Model: Lighthouse API keys (20%) vs UCAN (70-85%) ‚Ä¢ (2) Economic: You pay (10%) vs Direct payment (85-95%) ‚Ä¢ (3) Infrastructure: Single provider (15%) vs Self-hosted IPFS Cluster (95%)",
                decentralization: "UCAN: User-owned identity ‚Ä¢ Direct smart contract access ‚Ä¢ Self-hosted IPFS nodes (85%) ‚Ä¢ Self-hosted IPFS Cluster (95%) - Maximum infrastructure sovereignty",
                implication: "Ring 4 = MIN(Identity, Economic, Infrastructure). If you use API keys (20%) but have perfect infrastructure (95%), Ring 4 is still 20%. Self-hosting IPFS Cluster eliminates third-party infrastructure dependency but cannot overcome weak identity or economic models."
            },
            ring5: {
                name: "CRYPTOGRAPHIC SOVEREIGNTY",
                radius: 90,
                color: "rgba(0, 255, 255, 0.3)",
                strokeColor: "#00ffff",
                sovereignty: 90,
                powerHolders: [
                    {
                        name: "Key Management Services",
                        power: "Store/manage private keys",
                        constraint: "Can lose keys, get hacked, refuse access",
                        resistance: "High - Single point of failure"
                    },
                    {
                        name: "Wallet Providers",
                        power: "Sign transactions, encrypt/decrypt",
                        constraint: "Can block operations, leak keys",
                        resistance: "Medium - Can use hardware wallets"
                    },
                    {
                        name: "Browser Vendors",
                        power: "WebCrypto API, sandboxing",
                        constraint: "Can disable crypto, introduce vulnerabilities",
                        resistance: "Medium - Can verify, use native apps"
                    },
                    {
                        name: "Encryption Service Providers",
                        power: "Kavach (Lighthouse), Lit Protocol",
                        constraint: "Can refuse to decrypt, lose keys, shut down",
                        resistance: "High - If you depend on them"
                    }
                ],
                currentPower: "Most users: MetaMask, browser crypto ‚Ä¢ Many use custodial wallets",
                decentralization: "WebCrypto API ‚Ä¢ Hardware wallets ‚Ä¢ Open-source crypto ‚Ä¢ Client-side encryption",
                implication: "If you don't control encryption keys, you don't control access‚Äîregardless of storage"
            },
            center: {
                name: "USER AGENCY",
                radius: 50,
                color: "rgba(0, 170, 255, 0.7)",
                strokeColor: "#00aaff",
                sovereignty: 40,
                capabilities: [
                    "Store data permanently",
                    "Retrieve data without permission",
                    "Control who accesses data",
                    "Move to different application",
                    "Prove ownership cryptographically",
                    "Resist censorship attempts",
                    "Survive platform shutdowns",
                    "Operate pseudonymously/anonymously"
                ],
                calculation: "MIN(40%, 50%, 70%, 85%, 90%) = 40%",
                principle: "Sovereignty is only as strong as the weakest outer ring"
            }
        };
        
        // DEVELOPER SOVEREIGNTY DATA
        const DEVELOPER_DATA = {
            ring1: {
                name: "PHYSICAL SOVEREIGNTY",
                radius: 450,
                color: "rgba(255, 107, 107, 0.3)",
                strokeColor: "#ff6b6b",
                sovereignty: 15,
                powerHolders: [
                    {
                        name: "Vercel / Netlify",
                        power: "Host your frontend, control deployment",
                        constraint: "Can terminate service, change pricing, delete deployments",
                        resistance: "High - You're dependent on their infrastructure"
                    },
                    {
                        name: "AWS / GCP / Azure",
                        power: "Cloud infrastructure, compute, storage",
                        constraint: "Can shut down accounts, change ToS, increase prices",
                        resistance: "High - Lock-in through proprietary APIs"
                    },
                    {
                        name: "Data Center Operators",
                        power: "Physical servers if you self-host",
                        constraint: "Can deny service, inspect hardware, raise costs",
                        resistance: "Medium - Can switch providers"
                    }
                ],
                currentPower: "Most DApps: Vercel (15%) or AWS (20%) ‚Ä¢ Self-hosting rare ‚Ä¢ IPFS pinning: 60-85%",
                decentralization: "IPFS self-pinning: 85% ‚Ä¢ Fleek (IPFS service): 60% ‚Ä¢ Traditional hosting: 15-20%",
                implication: "If Vercel bans you, your users lose access to your DApp‚Äîeven if data is on IPFS"
            },
            ring2: {
                name: "NETWORK SOVEREIGNTY",
                radius: 360,
                color: "rgba(255, 170, 0, 0.3)",
                strokeColor: "#ffaa00",
                sovereignty: 10,
                powerHolders: [
                    {
                        name: "Domain Registrars",
                        power: "Control .com/.io/.app domains",
                        constraint: "Can revoke domains, block transfers, change pricing",
                        resistance: "Very High - ICANN-controlled system"
                    },
                    {
                        name: "ICANN / DNS System",
                        power: "Root DNS, domain namespace",
                        constraint: "Can disable domains, block TLDs",
                        resistance: "Very High - Global monopoly"
                    },
                    {
                        name: "CDN Providers",
                        power: "Content distribution, DDoS protection",
                        constraint: "Can refuse service, block content",
                        resistance: "Medium - Multiple alternatives"
                    }
                ],
                currentPower: "GoDaddy/Namecheap: 10% ‚Ä¢ Cloudflare: 30% ‚Ä¢ ENS .eth: 80% ‚Ä¢ Direct IPFS CID: 90%",
                decentralization: "ENS: Ethereum-based naming (80%) ‚Ä¢ Handshake: Decentralized DNS ‚Ä¢ Direct CID access",
                implication: "If registrar seizes your domain, users can't find your DApp"
            },
            ring3: {
                name: "PROTOCOL SOVEREIGNTY",
                radius: 270,
                color: "rgba(255, 255, 0, 0.3)",
                strokeColor: "#ffff00",
                sovereignty: 70,
                powerHolders: [
                    {
                        name: "Protocol Labs / Filecoin Foundation",
                        power: "IPFS/Filecoin protocol development",
                        constraint: "Can push breaking changes, deprecate features",
                        resistance: "Medium - Open source, can fork"
                    },
                    {
                        name: "npm / Package Registries",
                        power: "Dependency distribution",
                        constraint: "Can delete packages, ban users, change ToS",
                        resistance: "Medium - Can mirror/vendor dependencies"
                    },
                    {
                        name: "Browser Vendors",
                        power: "Web APIs, standards implementation",
                        constraint: "Can deprecate APIs, introduce restrictions",
                        resistance: "Low - Standards-based"
                    }
                ],
                currentPower: "Assuming IPFS/Filecoin usage (70%) ‚Ä¢ npm required (40%) ‚Ä¢ Browsers standard (80%)",
                decentralization: "Open protocols ‚Ä¢ Multiple implementations ‚Ä¢ Can vendor dependencies ‚Ä¢ Progressive enhancement",
                implication: "Open protocols give you options, but npm dependency creates vulnerability"
            },
            ring4: {
                name: "PLATFORM SOVEREIGNTY",
                radius: 180,
                color: "rgba(0, 255, 170, 0.3)",
                strokeColor: "#00ffaa",
                sovereignty: 15,
                powerHolders: [
                    {
                        name: "GitHub",
                        power: "Code hosting, version control, collaboration",
                        constraint: "Can delete repos, ban accounts, change features",
                        resistance: "High - Everyone uses it, network effects"
                    },
                    {
                        name: "GitLab / Bitbucket",
                        power: "Alternative code hosting",
                        constraint: "Same centralized risks as GitHub",
                        resistance: "High - Still centralized platforms"
                    },
                    {
                        name: "CI/CD Platforms",
                        power: "Build, test, deploy pipelines",
                        constraint: "Can fail builds, leak secrets, disable accounts",
                        resistance: "Medium - Can self-host runners"
                    }
                ],
                currentPower: "GitHub monopoly: 15% ‚Ä¢ Radicle P2P: 95% ‚Ä¢ GitLab: 20% ‚Ä¢ Self-hosted Git: 70%",
                decentralization: "Radicle: P2P Git (95%) ‚Ä¢ Self-hosted GitLab (70%) ‚Ä¢ Git protocol itself (100%)",
                implication: "GitHub can delete your repo. Users can't fork if you're deplatformed."
            },
            ring5: {
                name: "CRYPTOGRAPHIC SOVEREIGNTY",
                radius: 90,
                color: "rgba(0, 255, 255, 0.3)",
                strokeColor: "#00ffff",
                sovereignty: 20,
                powerHolders: [
                    {
                        name: "GitHub Secrets / CI Secrets",
                        power: "Store deployment keys, API keys",
                        constraint: "Can leak secrets, lock accounts, audit access",
                        resistance: "High - Required for CI/CD"
                    },
                    {
                        name: "Key Management Services",
                        power: "AWS KMS, Google Secret Manager",
                        constraint: "Can refuse access, lose keys, change pricing",
                        resistance: "High - Vendor lock-in"
                    },
                    {
                        name: "Developer Laptops",
                        power: "Local private keys, signing keys",
                        constraint: "Can be stolen, hacked, lost",
                        resistance: "Medium - Your physical security"
                    }
                ],
                currentPower: "Most use GitHub Secrets (20%) ‚Ä¢ Some use AWS KMS (30%) ‚Ä¢ Hardware wallets rare (90%)",
                decentralization: "Hardware wallet signing (90%) ‚Ä¢ Multisig (80%) ‚Ä¢ Local keyfiles (50%) ‚Ä¢ GitHub: 20%",
                implication: "If GitHub locks you out, you can't deploy. If they leak secrets, you're compromised."
            },
            center: {
                name: "DAPP AGENCY",
                radius: 50,
                color: "rgba(0, 170, 255, 0.7)",
                strokeColor: "#00aaff",
                sovereignty: 10,
                capabilities: [
                    "‚ùå Can be deplatformed from GitHub",
                    "‚ùå Can lose domain name",
                    "‚ùå Can be banned from hosting",
                    "‚ùå Secrets controlled by platforms",
                    "‚ö†Ô∏è Protocol is open (good)",
                    "‚ö†Ô∏è Can migrate with effort",
                    "‚ö†Ô∏è Users lose access during migration",
                    "‚ùå Network effects lock you in"
                ],
                calculation: "MIN(15%, 10%, 70%, 15%, 20%) = 10%",
                principle: "Despite giving users 70-90% sovereignty, YOUR infrastructure has only 10%!"
            }
        };
        
        // OVERALL SOVEREIGNTY DATA (combines both)
        const OVERALL_DATA = {
            ring1: {
                name: "PHYSICAL",
                radius: 450,
                color: "rgba(255, 107, 107, 0.3)",
                strokeColor: "#ff6b6b",
                userSov: 40,
                devSov: 15,
                combined: 15,
                explanation: "User data on Filecoin (40%) + Your frontend on Vercel (15%) = MIN = 15%",
                implication: "If Vercel terminates you, users can't access interface‚Äîeven if their data is safe on Filecoin"
            },
            ring2: {
                name: "NETWORK",
                radius: 360,
                color: "rgba(255, 170, 0, 0.3)",
                strokeColor: "#ffaa00",
                userSov: 50,
                devSov: 10,
                combined: 10,
                explanation: "Users can access via IPFS (50%) + Your domain on GoDaddy (10%) = MIN = 10%",
                implication: "If domain seized, users lose primary way to find your DApp"
            },
            ring3: {
                name: "PROTOCOL",
                radius: 270,
                color: "rgba(255, 255, 0, 0.3)",
                strokeColor: "#ffff00",
                userSov: 70,
                devSov: 70,
                combined: 70,
                explanation: "Both use open IPFS/Filecoin protocols = 70%",
                implication: "Protocol layer is strong‚Äîthis is good! Both can verify and fork if needed."
            },
            ring4: {
                name: "PLATFORM",
                radius: 180,
                color: "rgba(0, 255, 170, 0.3)",
                strokeColor: "#00ffaa",
                userSov: 85,
                devSov: 15,
                combined: 15,
                explanation: "Users have UCAN identity (85%) + Your code on GitHub (15%) = MIN = 15%",
                implication: "GitHub can delete your repo. Users keep their identity but lose the application."
            },
            ring5: {
                name: "CRYPTOGRAPHIC",
                radius: 90,
                color: "rgba(0, 255, 255, 0.3)",
                strokeColor: "#00ffff",
                userSov: 90,
                devSov: 20,
                combined: 20,
                explanation: "Users control keys (90%) + Your secrets in GitHub Actions (20%) = MIN = 20%",
                implication: "Users safe, but YOUR deployment keys vulnerable to GitHub"
            },
            center: {
                name: "OVERALL SOVEREIGNTY",
                radius: 50,
                color: "rgba(0, 170, 255, 0.7)",
                strokeColor: "#00aaff",
                sovereignty: 10,
                calculation: "MIN(15%, 10%, 70%, 15%, 20%) = 10%",
                principle: "Your developer infrastructure (10%) drags down user sovereignty (40%)",
                reality: "Even with excellent user sovereignty design, developer dependencies create systemic risk"
            }
        };
        
        // Drawing function
        function drawDiagram(svgId, data, panelId, isDev = false, isOverall = false) {
            const svg = document.getElementById(svgId);
            svg.innerHTML = '';
            const centerX = 500, centerY = 500;
            
            ['ring1', 'ring2', 'ring3', 'ring4', 'ring5'].forEach(key => {
                const ring = data[key];
                
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', centerX);
                circle.setAttribute('cy', centerY);
                circle.setAttribute('r', ring.radius);
                circle.setAttribute('fill', ring.color);
                circle.setAttribute('stroke', ring.strokeColor);
                circle.setAttribute('stroke-width', '3');
                circle.setAttribute('class', 'ring');
                svg.appendChild(circle);
                
                const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                label.setAttribute('x', centerX);
                label.setAttribute('y', centerY - ring.radius - 10);
                label.setAttribute('class', 'ring-label');
                label.textContent = ring.name;
                svg.appendChild(label);
                
                const score = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                score.setAttribute('x', centerX);
                score.setAttribute('y', centerY - ring.radius + 15);
                score.setAttribute('class', 'sovereignty-score');
                score.textContent = isOverall ? `${ring.combined}%` : `${ring.sovereignty}%`;
                svg.appendChild(score);
                
                circle.addEventListener('click', () => showInfo(panelId, key, ring, isDev, isOverall));
            });
            
            const center = data.center;
            const centerCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            centerCircle.setAttribute('cx', centerX);
            centerCircle.setAttribute('cy', centerY);
            centerCircle.setAttribute('r', center.radius);
            centerCircle.setAttribute('fill', center.color);
            centerCircle.setAttribute('stroke', center.strokeColor);
            centerCircle.setAttribute('stroke-width', '3');
            centerCircle.setAttribute('class', 'ring');
            svg.appendChild(centerCircle);
            
            const centerLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            centerLabel.setAttribute('x', centerX);
            centerLabel.setAttribute('y', centerY);
            centerLabel.setAttribute('class', 'ring-label');
            centerLabel.textContent = isDev ? 'DAPP' : isOverall ? 'OVERALL' : 'USER';
            svg.appendChild(centerLabel);
            
            const centerScore = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            centerScore.setAttribute('x', centerX);
            centerScore.setAttribute('y', centerY + 20);
            centerScore.setAttribute('class', 'sovereignty-score');
            centerScore.setAttribute('font-size', '16');
            centerScore.textContent = `${center.sovereignty}%`;
            svg.appendChild(centerScore);
            
            centerCircle.addEventListener('click', () => showInfo(panelId, 'center', center, isDev, isOverall));
        }
        
        // Info display function
        function showInfo(panelId, ringKey, ring, isDev, isOverall) {
            const panel = document.getElementById(panelId);
            let html = '';
            
            if (ringKey === 'center') {
                html = `
                    <h2>${ring.name}</h2>
                    <p><strong>Final Score:</strong> <span class="score-badge">${ring.sovereignty}%</span></p>
                    <p><strong>Calculation:</strong> ${ring.calculation}</p>
                    <div class="info-section">
                        <p><strong>Principle:</strong> ${ring.principle}</p>
                    </div>
                `;
                
                if (isOverall) {
                    html += `<p style="margin-top: 15px;">${ring.reality}</p>`;
                }
                
                if (ring.capabilities) {
                    html += '<h3>What This Enables:</h3><ul>';
                    ring.capabilities.forEach(cap => {
                        html += `<li>${cap}</li>`;
                    });
                    html += '</ul>';
                }
            } else if (isOverall) {
                html = `
                    <h2>${ring.name} SOVEREIGNTY</h2>
                    <div class="info-section">
                        <p><strong>User Sovereignty:</strong> ${ring.userSov}%</p>
                        <p><strong>Developer Sovereignty:</strong> ${ring.devSov}%</p>
                        <p><strong>Combined:</strong> MIN(${ring.userSov}%, ${ring.devSov}%) = <span class="score-badge">${ring.combined}%</span></p>
                    </div>
                    <p style="margin-top: 15px;"><strong>Explanation:</strong> ${ring.explanation}</p>
                    <div class="info-section" style="border-left-color: #ffaa00; background: rgba(255, 170, 0, 0.05);">
                        <p class="constraint"><strong>Implication:</strong> ${ring.implication}</p>
                    </div>
                `;
            } else {
                html = `
                    <h2>${ring.name}</h2>
                    <p><strong>Sovereignty at This Layer:</strong> <span class="score-badge">${ring.sovereignty}%</span></p>
                `;
                
                // Special section for Ring 4 explaining the three dimensions
                if (ringKey === 'ring4' && !isDev) {
                    html += `
                        <div class="info-section" style="border-left-color: #00ffff; background: rgba(0, 255, 255, 0.1); margin: 15px 0;">
                            <h3 style="color: #00ffff; margin-top: 0;">Ring 4 Has THREE Dimensions:</h3>
                            <p><strong>1. Identity Model (Storage Identity):</strong> How users authenticate and own their data namespace</p>
                            <ul style="margin: 8px 0 15px 20px;">
                                <li>API Key Model: 20% (all users share your key)</li>
                                <li>UCAN Identity: 70% (user-owned namespace)</li>
                                <li>UCAN + On-Chain Registry: 85% (full ownership proof)</li>
                            </ul>
                            
                            <p><strong>2. Economic Model (Payment):</strong> Who pays for storage and how</p>
                            <ul style="margin: 8px 0 15px 20px;">
                                <li>You Pay: 10% (complete dependency)</li>
                                <li>Subscription Through You: 40%</li>
                                <li>Direct Payment to Provider: 70%</li>
                                <li>Perpetual Payment: 85%</li>
                                <li>Direct Filecoin Deals: 95%</li>
                            </ul>
                            
                            <p><strong>3. Infrastructure Model (Storage Infrastructure):</strong> Where data is stored and who controls it</p>
                            <ul style="margin: 8px 0 15px 20px;">
                                <li>Single Provider: 15% (high risk)</li>
                                <li>Multiple Providers, Multiple Jurisdictions: 60%</li>
                                <li>User-Selectable Providers: 75%</li>
                                <li><strong style="color: #00ffff;">Self-Hosted IPFS Node: 85%</strong> (full infrastructure control)</li>
                                <li><strong style="color: #00ffff;">Self-Hosted IPFS Cluster: 95%</strong> (maximum sovereignty - redundancy + control)</li>
                            </ul>
                            
                            <p style="margin-top: 15px; color: #ffaa00;"><strong>Ring 4 = MIN(Identity, Economic, Infrastructure)</strong></p>
                            <p style="font-size: 0.9rem;">The weakest dimension determines your Ring 4 score. Self-hosting eliminates third-party infrastructure dependency but cannot overcome weak identity or economic models.</p>
                        </div>
                    `;
                }
                
                html += `<h3>Power Holders & Constraints:</h3>`;
                
                ring.powerHolders.forEach(holder => {
                    html += `
                        <div class="power-holder">
                            <h4>${holder.name}</h4>
                            <p><strong>Power:</strong> ${holder.power}</p>
                            <p class="constraint"><strong>Constraint:</strong> ${holder.constraint}</p>
                            <p><strong>Resistance Level:</strong> ${holder.resistance}</p>
                        </div>
                    `;
                });
                
                html += `
                    <h3>Current State of Power:</h3>
                    <div class="info-section">
                        <p>${ring.currentPower}</p>
                    </div>
                    
                    <h3>Decentralization Attempts:</h3>
                    <div class="info-section">
                        <p>${ring.decentralization}</p>
                    </div>
                    
                    <h3>Implication for ${isDev ? 'Your DApp' : 'Users'}:</h3>
                    <div class="info-section" style="border-left-color: #ffaa00; background: rgba(255, 170, 0, 0.05);">
                        <p class="constraint">${ring.implication}</p>
                    </div>
                `;
            }
            
            panel.innerHTML = html;
            panel.scrollTop = 0;
        }
        
        // Initialize all diagrams
        drawDiagram('user-diagram', USER_DATA, 'user-panel', false, false);
        drawDiagram('developer-diagram', DEVELOPER_DATA, 'developer-panel', true, false);
        drawDiagram('overall-diagram', OVERALL_DATA, 'overall-panel', false, true);
        
        // Show initial info for user diagram
        showInfo('user-panel', 'center', USER_DATA.center, false, false);
    </script>
</body>
</html>

<!-- Add this after the nav-tabs div and before the first tab-content -->
<script>
// First, let's insert the Radicle tab button and content
document.addEventListener('DOMContentLoaded', function() {
    // Add tab button
    const navTabs = document.querySelector('.nav-tabs');
    const radicleButton = document.createElement('button');
    radicleButton.className = 'tab-button';
    radicleButton.onclick = () => switchTab('radicle');
    radicleButton.innerHTML = 'üå± Case Study: Radicle';
    navTabs.appendChild(radicleButton);
    
    // Add tab content
    const container = document.querySelector('.container');
    const radicleTab = document.createElement('div');
    radicleTab.id = 'radicle-tab';
    radicleTab.className = 'tab-content';
    radicleTab.innerHTML = `
        <div style="max-width: 1200px; margin: 0 auto; padding: 20px;">
            <h2 style="color: #00ffff; text-align: center; margin-bottom: 15px; font-size: 2rem;">üå± Case Study: Radicle</h2>
            <p style="text-align: center; color: #8888aa; margin-bottom: 40px; font-size: 1rem;">
                Achieving 70% Developer Sovereignty through P2P Architecture
            </p>
            
            <div style="background: rgba(255, 170, 0, 0.1); border: 2px solid #ffaa00; border-radius: 10px; padding: 25px; margin-bottom: 30px;">
                <h3 style="color: #ffaa00; margin-top: 0; font-size: 1.3rem;">üéØ What We're Analyzing</h3>
                <p style="font-size: 1.05rem;"><strong>Radicle is a DEVELOPER TOOL</strong> (peer-to-peer code collaboration platform), NOT an end-user application.</p>
                <p style="margin-top: 12px;"><strong>Who are the "users"?</strong> Developers themselves‚Äîthey use Radicle to collaborate on code.</p>
                <p style="margin-top: 12px;"><strong>Analysis Type:</strong> Developer/DApp Sovereignty ONLY</p>
                <p style="margin-top: 15px; font-size: 1.1rem; color: #ffaa00;"><strong>Key Lesson:</strong> Radicle is a blueprint for maximizing YOUR DApp's developer sovereignty‚Äîshowing how to avoid GitHub/centralized platform dependency.</p>
            </div>
            
            <div style="background: rgba(20, 20, 40, 0.6); border: 2px solid #00ffff; border-radius: 10px; padding: 35px;">
                <h3 style="color: #00ffff; margin-top: 0; font-size: 1.5rem;">What is Radicle?</h3>
                <p style="font-size: 1.05rem;">Radicle is a peer-to-peer code collaboration platform built on Git that eliminates the need for centralized forges like GitHub. Developers collaborate directly through a gossip protocol with cryptographic identities.</p>
                
                <h4 style="color: #00ffaa; margin-top: 25px; font-size: 1.2rem;">Key Features:</h4>
                <ul style="line-height: 1.8; font-size: 1.05rem;">
                    <li><strong>True peer-to-peer:</strong> No central server required</li>
                    <li><strong>Local-first:</strong> Repositories, issues, and patches stored locally on your device</li>
                    <li><strong>Cryptographic identity:</strong> Developers identified by keypairs, not usernames</li>
                    <li><strong>Built on Git:</strong> Extends Git rather than replacing it</li>
                    <li><strong>Works offline:</strong> Full collaboration capability without internet</li>
                    <li><strong>No blockchain/cryptocurrency:</strong> Pure p2p protocol</li>
                </ul>
                
                <h3 style="color: #00ffff; margin-top: 35px; font-size: 1.5rem;">üìä Developer Sovereignty Analysis</h3>
                
                <div style="background: rgba(0, 255, 170, 0.1); border-left: 4px solid #00ffaa; padding: 20px; margin: 25px 0; border-radius: 5px;">
                    <h4 style="color: #00ffaa; margin-top: 0; font-size: 1.2rem;">Ring 4: Platform (Code Hosting)</h4>
                    <p style="font-size: 1.3rem; font-weight: 700; color: #00ffaa;">95% Sovereignty ‚≠ê</p>
                    
                    <p style="margin-top: 15px;"><strong>What Radicle Achieves:</strong></p>
                    <ul style="line-height: 1.7;">
                        <li>‚úÖ No GitHub dependency‚Äîcode hosted peer-to-peer</li>
                        <li>‚úÖ Peer-to-peer repository replication via gossip protocol</li>
                        <li>‚úÖ Cryptographic project identities (no accounts)</li>
                        <li>‚úÖ Can fork and contribute without platform permission</li>
                        <li>‚úÖ Issues and PRs are local Git objects (portable)</li>
                    </ul>
                    
                    <p style="margin-top: 15px;"><strong>Power Holders Bypassed:</strong></p>
                    <ul style="line-height: 1.7;">
                        <li>‚ùå GitHub/Microsoft cannot delete your repo</li>
                        <li>‚ùå GitLab cannot ban your account</li>
                        <li>‚ùå All centralized forges eliminated</li>
                    </ul>
                    
                    <p style="margin-top: 15px;"><strong>Remaining Constraints:</strong></p>
                    <ul style="line-height: 1.7;">
                        <li>‚ö†Ô∏è Optional seed nodes (Radicle Foundation operates some for discoverability)</li>
                        <li>‚ö†Ô∏è Protocol development coordinated by Radworks</li>
                        <li>‚ö†Ô∏è Still evolving (some features immature)</li>
                    </ul>
                </div>
                
                <h4 style="color: #00ffaa; margin-top: 30px; font-size: 1.2rem;">Complete Ring Analysis</h4>
                
                <table style="width: 100%; border-collapse: collapse; margin: 25px 0; font-size: 0.95rem;">
                    <thead>
                        <tr style="background: rgba(0, 255, 255, 0.1);">
                            <th style="padding: 12px; text-align: left; color: #00ffff; border-bottom: 2px solid #00ffff;">Ring</th>
                            <th style="padding: 12px; text-align: center; color: #00ffff; border-bottom: 2px solid #00ffff;">Score</th>
                            <th style="padding: 12px; text-align: left; color: #00ffff; border-bottom: 2px solid #00ffff;">Key Achievements</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="border-bottom: 1px solid #333;">
                            <td style="padding: 12px;"><strong>Ring 1: Physical</strong></td>
                            <td style="padding: 12px; text-align: center; font-weight: 700; color: #ffaa00;">70%</td>
                            <td style="padding: 12px;">Self-hosted nodes, no data centers needed</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #333;">
                            <td style="padding: 12px;"><strong>Ring 2: Network</strong></td>
                            <td style="padding: 12px; text-align: center; font-weight: 700; color: #ffaa00;">70%</td>
                            <td style="padding: 12px;">P2P gossip protocol, works offline</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #333;">
                            <td style="padding: 12px;"><strong>Ring 3: Protocol</strong></td>
                            <td style="padding: 12px; text-align: center; font-weight: 700; color: #00ffaa;">85%</td>
                            <td style="padding: 12px;">Built on Git, fully open source</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #333;">
                            <td style="padding: 12px;"><strong>Ring 4: Platform</strong></td>
                            <td style="padding: 12px; text-align: center; font-weight: 700; color: #00ff00;">95% ‚≠ê</td>
                            <td style="padding: 12px;">No GitHub! P2P collaboration</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #333;">
                            <td style="padding: 12px;"><strong>Ring 5: Cryptographic</strong></td>
                            <td style="padding: 12px; text-align: center; font-weight: 700; color: #00ffaa;">85%</td>
                            <td style="padding: 12px;">Cryptographic identities, local keys</td>
                        </tr>
                        <tr style="background: rgba(0, 255, 255, 0.15);">
                            <td style="padding: 15px;"><strong>FINAL RESULT</strong></td>
                            <td style="padding: 15px; text-align: center; font-weight: 700; font-size: 1.3rem; color: #00ffff;">70%</td>
                            <td style="padding: 15px;"><strong>MIN(70, 70, 85, 95, 85)</strong></td>
                        </tr>
                    </tbody>
                </table>
                
                <div style="background: rgba(0, 255, 255, 0.1); border: 2px solid #00ffff; border-radius: 10px; padding: 20px; margin: 25px 0;">
                    <h4 style="color: #00ffff; margin-top: 0;">üéØ Result: 70% Developer Sovereignty</h4>
                    <p style="font-size: 1.15rem;">This is <strong>significantly higher</strong> than projects hosted on GitHub (15%), making Radicle one of the most sovereign developer platforms available.</p>
                </div>
                
                <h3 style="color: #00ffff; margin-top: 35px; font-size: 1.5rem;">üìà Comparison: Radicle vs GitHub</h3>
                
                <table style="width: 100%; border-collapse: collapse; margin: 25px 0; font-size: 0.95rem;">
                    <thead>
                        <tr style="background: rgba(0, 255, 255, 0.1);">
                            <th style="padding: 12px; text-align: left; color: #00ffff; border-bottom: 2px solid #00ffff;">Aspect</th>
                            <th style="padding: 12px; text-align: center; color: #00ffff; border-bottom: 2px solid #00ffff;">GitHub-Based</th>
                            <th style="padding: 12px; text-align: center; color: #00ffff; border-bottom: 2px solid #00ffff;">Radicle-Based</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="border-bottom: 1px solid #333;">
                            <td style="padding: 12px;"><strong>Code Hosting</strong></td>
                            <td style="padding: 12px; text-align: center; color: #ff6b6b;">Microsoft controls (15%)</td>
                            <td style="padding: 12px; text-align: center; color: #00ff00;">P2P, no platform (95%)</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #333;">
                            <td style="padding: 12px;"><strong>Developer Identity</strong></td>
                            <td style="padding: 12px; text-align: center;">GitHub username</td>
                            <td style="padding: 12px; text-align: center;">Cryptographic keypair</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #333;">
                            <td style="padding: 12px;"><strong>Issues & PRs</strong></td>
                            <td style="padding: 12px; text-align: center; color: #ff6b6b;">Platform-locked</td>
                            <td style="padding: 12px; text-align: center; color: #00ff00;">Local Git objects</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #333;">
                            <td style="padding: 12px;"><strong>Deplatforming Risk</strong></td>
                            <td style="padding: 12px; text-align: center; color: #ff6b6b;">High</td>
                            <td style="padding: 12px; text-align: center; color: #00ff00;">None‚Äîno platform</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #333;">
                            <td style="padding: 12px;"><strong>Offline Collaboration</strong></td>
                            <td style="padding: 12px; text-align: center;">Read-only</td>
                            <td style="padding: 12px; text-align: center; color: #00ff00;">Full functionality</td>
                        </tr>
                        <tr style="border-bottom: 1px solid #333;">
                            <td style="padding: 12px;"><strong>Censorship Resistance</strong></td>
                            <td style="padding: 12px; text-align: center; color: #ff6b6b;">Low</td>
                            <td style="padding: 12px; text-align: center; color: #00ff00;">High</td>
                        </tr>
                        <tr style="background: rgba(0, 255, 255, 0.1);">
                            <td style="padding: 15px;"><strong>Developer Sovereignty</strong></td>
                            <td style="padding: 15px; text-align: center; font-weight: 700; font-size: 1.2rem; color: #ff6b6b;">15%</td>
                            <td style="padding: 15px; text-align: center; font-weight: 700; font-size: 1.2rem; color: #00ffff;">70%</td>
                        </tr>
                    </tbody>
                </table>
                
                <h3 style="color: #00ffff; margin-top: 35px; font-size: 1.5rem;">üí° Key Lessons for Your DApp</h3>
                
                <div style="background: rgba(0, 255, 170, 0.1); border-left: 4px solid #00ffaa; padding: 20px; margin: 20px 0; border-radius: 5px;">
                    <h4 style="color: #00ffaa; margin-top: 0;">1. Eliminate Platform Dependency (Ring 4)</h4>
                    <ul style="line-height: 1.7;">
                        <li>Don't just focus on giving users sovereignty‚Äîachieve it for your DApp infrastructure too</li>
                        <li>Your code shouldn't depend on GitHub staying open to you</li>
                        <li><strong>Question to ask:</strong> Can your project survive if GitHub bans you tomorrow?</li>
                    </ul>
                </div>
                
                <div style="background: rgba(0, 255, 170, 0.1); border-left: 4px solid #00ffaa; padding: 20px; margin: 20px 0; border-radius: 5px;">
                    <h4 style="color: #00ffaa; margin-top: 0;">2. Local-First Architecture</h4>
                    <ul style="line-height: 1.7;">
                        <li>Everything works offline first</li>
                        <li>Network is for syncing, not primary operations</li>
                        <li>Users (developers) have complete local control</li>
                    </ul>
                </div>
                
                <div style="background: rgba(0, 255, 170, 0.1); border-left: 4px solid #00ffaa; padding: 20px; margin: 20px 0; border-radius: 5px;">
                    <h4 style="color: #00ffaa; margin-top: 0;">3. Cryptographic Identity</h4>
                    <ul style="line-height: 1.7;">
                        <li>No accounts/usernames controlled by a platform</li>
                        <li>Identity is portable across all instances</li>
                        <li>All actions cryptographically signed and verifiable</li>
                    </ul>
                </div>
                
                <div style="background: rgba(0, 255, 170, 0.1); border-left: 4px solid #00ffaa; padding: 20px; margin: 20px 0; border-radius: 5px;">
                    <h4 style="color: #00ffaa; margin-top: 0;">4. The Trade-off</h4>
                    <ul style="line-height: 1.7;">
                        <li>Higher sovereignty = More complexity for users</li>
                        <li>Network effects matter (GitHub has more developers)</li>
                        <li>Less mature tooling ecosystem</li>
                        <li>Higher cognitive load</li>
                    </ul>
                </div>
                
                <h3 style="color: #00ffff; margin-top: 35px; font-size: 1.5rem;">üéì Applying to Your Storage DApp</h3>
                
                <div style="background: rgba(0, 0, 0, 0.4); border: 1px solid #333; border-radius: 8px; padding: 20px; margin: 20px 0; font-family: 'Courier New', monospace; font-size: 0.9rem;">
// Your Storage DApp Infrastructure Analysis

User Sovereignty (from User tab):
- Identity: UCAN (70%)
- Encryption: Client-side (80%)
- Retrieval: Multiple gateways (60%)
‚Üí User Sovereignty = 40% (limited by outer rings)

Developer Sovereignty (typical GitHub stack):
- Code: GitHub (15%) ‚Üê WEAK LINK!
- Deployment: Vercel (20%) ‚Üê WEAK LINK!
- Domain: GoDaddy (10%) ‚Üê WEAKEST LINK!
- Keys: GitHub Secrets (20%)
‚Üí Developer Sovereignty = 10%

Overall DApp Sovereignty = MIN(40%, 10%) = 10%

Problem: Your users might have good sovereignty, but YOUR
infrastructure is highly vulnerable to deplatforming!
                </div>
                
                <h4 style="color: #00ffaa; margin-top: 30px; font-size: 1.2rem;">‚úÖ Better Architecture (Inspired by Radicle)</h4>
                
                <div style="background: rgba(0, 255, 0, 0.05); border: 1px solid #00ff00; border-radius: 8px; padding: 20px; margin: 20px 0; font-family: 'Courier New', monospace; font-size: 0.9rem;">
// Radicle-Inspired Sovereign Stack

Developer Sovereignty:
- Code: Radicle (95%) or GitHub + IPFS backup (60%)
- Deployment: Self-pinned IPFS (85%)
- Domain: ENS .eth domain (80%)
- Keys: Hardware wallet (90%)
‚Üí Developer Sovereignty = 60-80%

User Sovereignty:
- Identity: UCAN (70%)
- Encryption: Client-side + wallet (90%)
- Retrieval: Multiple gateways + node education (80%)
‚Üí User Sovereignty = 40% (still limited by outer rings)

Overall DApp Sovereignty = MIN(40%, 60%) = 40%

Result: 4x improvement from 10% ‚Üí 40%!
                </div>
                
                <div style="background: rgba(255, 107, 107, 0.1); border: 2px solid #ff6b6b; border-radius: 10px; padding: 25px; margin: 30px 0;">
                    <h4 style="color: #ff6b6b; margin-top: 0; font-size: 1.2rem;">üéØ The Reality Check</h4>
                    <p style="font-size: 1.05rem;">Most developers still choose GitHub's <strong>15% sovereignty</strong> for the <strong>85% better network effects and tooling</strong>.</p>
                    <p style="margin-top: 15px;">Radicle proves that <strong>70-95% developer sovereignty is technically achievable</strong>, but it comes with trade-offs:</p>
                    <ul style="line-height: 1.7;">
                        <li>Smaller user base / network effects</li>
                        <li>Less mature CI/CD tooling</li>
                        <li>Higher learning curve</li>
                        <li>Slower adoption</li>
                    </ul>
                    <p style="margin-top: 15px; font-size: 1.05rem;"><strong>The middle ground:</strong> GitHub + IPFS backup = 60% sovereignty with familiar tools</p>
                </div>
                
                <h3 style="color: #00ffff; margin-top: 35px; font-size: 1.5rem;">üìö Resources</h3>
                <ul style="line-height: 1.8; font-size: 1.05rem;">
                    <li><a href="https://radicle.xyz" style="color: #00ffff; text-decoration: none;">radicle.xyz</a> - Official website</li>
                    <li><a href="https://radicle.xyz/guides/protocol" style="color: #00ffff; text-decoration: none;">Protocol Guide</a> - Technical documentation</li>
                    <li><a href="https://github.com/radicle-dev" style="color: #00ffff; text-decoration: none;">Radicle on GitHub</a> - They use it for reach</li>
                    <li><a href="https://radicle.xyz/desktop" style="color: #00ffff; text-decoration: none;">Radicle Desktop App</a> - Get started</li>
                </ul>
            </div>
        </div>
    `;
    
    container.appendChild(radicleTab);
});

// Calculator functionality
const selections = {
    '4': null,
    '4b': null,
    '4c': null
};

function selectChoice(element) {
    const ring = element.getAttribute('data-ring');
    const value = parseInt(element.getAttribute('data-value'));
    
    // Deselect others in same ring
    document.querySelectorAll(`[data-ring="${ring}"]`).forEach(el => {
        el.classList.remove('selected');
    });
    
    // Select this one
    element.classList.add('selected');
    selections[ring] = value;
}

function calculateSovereignty() {
    // Validate all selections
    if (!selections['4'] || !selections['4b'] || !selections['4c']) {
        alert('Please make a selection for each Ring 4 category before calculating.');
        return;
    }
    
    // Outer rings (fixed)
    const ring1 = 40; // Physical
    const ring2 = 50; // Network
    const ring3 = 70; // Protocol
    
    // Inner rings (user choices) - Ring 4 is MIN of all three dimensions
    const ring4Platform = selections['4'];
    const ring4Economic = selections['4b'];
    const ring4Infrastructure = selections['4c'];
    const ring4 = Math.min(ring4Platform, ring4Economic, ring4Infrastructure);
    
    // Final score = MIN of all rings
    const finalScore = Math.min(ring1, ring2, ring3, ring4);
    
    // Display results
    document.getElementById('final-score').textContent = finalScore + '%';
    document.getElementById('progress-fill').style.width = finalScore + '%';
    document.getElementById('progress-text').textContent = finalScore + '%';
    
    // Breakdown
    const breakdown = document.getElementById('score-breakdown');
    breakdown.innerHTML = `
        <div class="score-item">
            <div class="score-item-title">Ring 1: Physical</div>
            <div class="score-item-value">${ring1}%</div>
            <div style="font-size: 0.8rem; color: #8888aa; margin-top: 5px;">Filecoin Network (Fixed)</div>
        </div>
        <div class="score-item">
            <div class="score-item-title">Ring 2: Network</div>
            <div class="score-item-value">${ring2}%</div>
            <div style="font-size: 0.8rem; color: #8888aa; margin-top: 5px;">libp2p/IPFS (Fixed)</div>
        </div>
        <div class="score-item">
            <div class="score-item-title">Ring 3: Protocol</div>
            <div class="score-item-value">${ring3}%</div>
            <div style="font-size: 0.8rem; color: #8888aa; margin-top: 5px;">IPFS/Filecoin (Fixed)</div>
        </div>
        <div class="score-item">
            <div class="score-item-title">Ring 4: Platform</div>
            <div class="score-item-value">${ring4}%</div>
            <div style="font-size: 0.8rem; color: #00ffff; margin-top: 5px;">MIN(Identity: ${ring4Platform}%, Economic: ${ring4Economic}%, Infrastructure: ${ring4Infrastructure}%)</div>
        </div>
    `;
    
    // Recommendations
    const recommendations = generateRecommendations(finalScore, ring4, ring4Platform, ring4Economic, ring4Infrastructure, selections);
    document.getElementById('recommendations').innerHTML = recommendations;
    
    // Show results
    document.getElementById('results').style.display = 'block';
    document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
}

function generateRecommendations(finalScore, ring4, ring4Platform, ring4Economic, ring4Infrastructure, selections) {
    let html = '<h4>üí° Recommendations to Improve Sovereignty</h4>';
    const recommendations = [];
    
    // Platform recommendations
    if (selections['4'] < 70) {
        recommendations.push({
            text: 'Upgrade to UCAN identity model (Storacha) instead of API keys',
            impact: `+${70 - selections['4']}% potential gain`,
            priority: 'HIGH'
        });
    }
    
    if (selections['4'] < 85) {
        recommendations.push({
            text: 'Add on-chain registry where users record their CIDs in their own smart contracts',
            impact: `+${85 - selections['4']}% potential gain`,
            priority: 'MEDIUM'
        });
    }
    
    // Economic recommendations
    if (selections['4b'] < 70) {
        recommendations.push({
            text: 'Allow users to pay storage providers directly instead of through you',
            impact: `+${70 - selections['4b']}% potential gain`,
            priority: 'MEDIUM'
        });
    }
    
    // Infrastructure recommendations - emphasizing self-hosting
    if (selections['4c'] < 60) {
        recommendations.push({
            text: 'Distribute data across multiple storage providers in different jurisdictions',
            impact: `+${60 - selections['4c']}% potential gain`,
            priority: 'HIGH'
        });
    }
    
    if (selections['4c'] < 75) {
        recommendations.push({
            text: 'Enable users to select their own storage providers from a decentralized network',
            impact: `+${75 - selections['4c']}% potential gain`,
            priority: 'MEDIUM'
        });
    }
    
    if (selections['4c'] < 85) {
        recommendations.push({
            text: 'Support self-hosted IPFS nodes - provide documentation and tooling for users to run their own IPFS node',
            impact: `+${85 - selections['4c']}% potential gain`,
            priority: 'HIGH'
        });
    }
    
    if (selections['4c'] < 95) {
        recommendations.push({
            text: 'Enable self-hosted IPFS Cluster - support users running multiple IPFS nodes for redundancy and high availability',
            impact: `+${95 - selections['4c']}% potential gain (maximum infrastructure sovereignty)`,
            priority: 'HIGH'
        });
    }
    
    if (recommendations.length === 0) {
        html += '<p style="color: #00ffff;">‚úÖ Excellent! You\'re using best practices for maximum feasible user sovereignty.</p>';
        html += '<div class="recommendation-item">';
        html += '<strong>Only constraint:</strong> Outer rings (Physical, Network, Protocol) limit final score to 40-70% regardless of your choices.';
        html += '<div style="margin-top: 10px; color: #8888aa;">This is the reality of current decentralized infrastructure. No individual can achieve 100% sovereignty.</div>';
        html += '</div>';
    } else {
        recommendations.forEach(rec => {
            html += '<div class="recommendation-item">';
            html += `<strong>[${rec.priority} PRIORITY]</strong> ${rec.text}`;
            html += `<div class="recommendation-impact">Impact: ${rec.impact}</div>`;
            html += '</div>';
        });
    }
    
    // Reality check
    html += '<div class="recommendation-item" style="margin-top: 20px; border-left-color: #ff6b6b;">';
    html += '<strong>üéØ The Hard Truth:</strong><br>';
    html += `Even with perfect implementation (85-95%), your final user sovereignty is limited to <strong>${Math.min(40, ring4)}%</strong> because of outer ring constraints.`;
    html += '<div style="margin-top: 10px;">Outer rings (Physical infrastructure, Network routing, Protocol governance) create a ceiling that individual DApps cannot overcome.</div>';
    html += '</div>';
    
    return html;
}

// Trilemma Analyzer
const TRILEMMA_ARCHITECTURES = [
    {
        name: 'Centralized Cloud (Dropbox)',
        sovereignty: 5,
        persistence: 95,
        practicality: 100,
        color: '#ef4444',
        description: 'Traditional model: maximum convenience, zero sovereignty'
    },
    {
        name: 'Lighthouse (API Key Model)',
        sovereignty: 20,
        persistence: 80,
        practicality: 85,
        color: '#f97316',
        description: 'Centralized API keys, all users share YOUR key. Data uploaded to YOUR account. Low sovereignty, decent persistence, easy to use'
    },
    {
        name: 'Storacha / Web3.Storage (UCAN)',
        sovereignty: 30,
        persistence: 85,
        practicality: 90,
        color: '#fb923c',
        description: 'UCAN identity model: better than API keys, but still service-dependent. Users own namespace but depend on Storacha infrastructure'
    },
    {
        name: 'Direct Lotus API',
        sovereignty: 40,
        persistence: 90,
        practicality: 40,
        color: '#eab308',
        description: 'More control, cryptographic guarantees, but still uses centralized Lotus endpoints. Complex setup, medium sovereignty ceiling'
    },
    {
        name: 'Direct Filecoin Deals (FRC-0068)',
        sovereignty: 50,
        persistence: 95,
        practicality: 25,
        color: '#a3e635',
        description: 'Users propose storage deals directly via smart contracts. No platform intermediary, but high complexity and technical requirements'
    },
    {
        name: 'Self-Hosted IPFS Node (Solo)',
        sovereignty: 85,
        persistence: 20,
        practicality: 50,
        color: '#06b6d4',
        description: 'User runs single IPFS node. Full infrastructure control, but no redundancy. Data persists only while node is running. User fully responsible'
    },
    {
        name: 'Self-Hosted IPFS Cluster',
        sovereignty: 95,
        persistence: 60,
        practicality: 45,
        color: '#00ffff',
        description: 'User runs multiple IPFS nodes (cluster) for redundancy. Maximum infrastructure sovereignty with geographic distribution. Still user-responsible but with redundancy'
    },
    {
        name: 'Mutual IPFS Pinning Network',
        sovereignty: 90,
        persistence: 40,
        practicality: 60,
        color: '#10b981',
        description: 'Users run IPFS nodes, voluntarily pin each other\'s content. High sovereignty, social persistence, moderate setup. Honest architecture'
    },
    {
        name: 'Self-Hosted IPFS + Filecoin Node',
        sovereignty: 80,
        persistence: 95,
        practicality: 15,
        color: '#84cc16',
        description: 'Full control + cryptographic storage proofs. Requires 1TB+ storage, days of syncing, expert-level technical knowledge'
    }
];

let selectedArchitecture = TRILEMMA_ARCHITECTURES[7]; // Mutual IPFS default
let customArchitecture = { sovereignty: 50, persistence: 50, practicality: 50 };

// Initialize trilemma when tab is shown
function initTrilemma() {
    renderArchitectureGrid();
    renderTriangle('triangle-svg', selectedArchitecture);
    updateScores(selectedArchitecture);
    renderTriangle('custom-triangle-svg', customArchitecture);
    updateCustomTotal();
}

function renderArchitectureGrid() {
    const grid = document.getElementById('architecture-grid');
    if (!grid) return;
    
    grid.innerHTML = TRILEMMA_ARCHITECTURES.map(arch => `
        <div class="architecture-card ${arch.name === selectedArchitecture.name ? 'selected' : ''}" 
             onclick="selectArchitecture('${arch.name}')">
            <div>
                <span class="architecture-color" style="background-color: ${arch.color};"></span>
                <span class="architecture-name">${arch.name}</span>
            </div>
            <div class="architecture-scores">
                S: ${arch.sovereignty}% | P: ${arch.persistence}% | Pr: ${arch.practicality}%
            </div>
        </div>
    `).join('');
}

function selectArchitecture(name) {
    selectedArchitecture = TRILEMMA_ARCHITECTURES.find(a => a.name === name);
    renderArchitectureGrid();
    renderTriangle('triangle-svg', selectedArchitecture);
    updateScores(selectedArchitecture);
    document.getElementById('selected-arch-name').textContent = selectedArchitecture.name;
    document.getElementById('selected-arch-description').textContent = selectedArchitecture.description;
    document.getElementById('trilemma-position').textContent = getTrilemmaPosition(selectedArchitecture);
}

function getTrilemmaPosition(arch) {
    const scores = [
        { dim: 'Sovereignty + Persistence', value: arch.sovereignty + arch.persistence },
        { dim: 'Persistence + Practicality', value: arch.persistence + arch.practicality },
        { dim: 'Sovereignty + Practicality', value: arch.sovereignty + arch.practicality }
    ];
    return scores.sort((a, b) => b.value - a.value)[0].dim;
}

function renderTriangle(svgId, arch) {
    const svg = document.getElementById(svgId);
    if (!svg) return;
    
    svg.innerHTML = '';
    const size = 400;
    const center = size / 2;
    const radius = size / 2 - 60;
    
    // Triangle vertices
    const vertices = {
        sovereignty: { x: center - radius * 0.866, y: center + radius * 0.5 },
        persistence: { x: center + radius * 0.866, y: center + radius * 0.5 },
        practicality: { x: center, y: 60 }
    };
    
    // Draw triangle
    const triangle = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
    triangle.setAttribute('points', 
        `${vertices.sovereignty.x},${vertices.sovereignty.y} ${vertices.persistence.x},${vertices.persistence.y} ${vertices.practicality.x},${vertices.practicality.y}`);
    triangle.setAttribute('fill', 'none');
    triangle.setAttribute('stroke', '#4b5563');
    triangle.setAttribute('stroke-width', '2');
    svg.appendChild(triangle);
    
    // Draw grid lines
    [0.25, 0.5, 0.75].forEach(factor => {
        const innerVertices = {
            sovereignty: { 
                x: center + (vertices.sovereignty.x - center) * factor,
                y: center + (vertices.sovereignty.y - center) * factor
            },
            persistence: { 
                x: center + (vertices.persistence.x - center) * factor,
                y: center + (vertices.persistence.y - center) * factor
            },
            practicality: { 
                x: center + (vertices.practicality.x - center) * factor,
                y: center + (vertices.practicality.y - center) * factor
            }
        };
        const gridLine = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
        gridLine.setAttribute('points',
            `${innerVertices.sovereignty.x},${innerVertices.sovereignty.y} ${innerVertices.persistence.x},${innerVertices.persistence.y} ${innerVertices.practicality.x},${innerVertices.practicality.y}`);
        gridLine.setAttribute('fill', 'none');
        gridLine.setAttribute('stroke', '#374151');
        gridLine.setAttribute('stroke-width', '1');
        gridLine.setAttribute('opacity', '0.3');
        svg.appendChild(gridLine);
    });
    
    // Labels
    const labels = [
        { text: 'Sovereignty', x: vertices.sovereignty.x - 35, y: vertices.sovereignty.y + 20, fill: '#00ffff' },
        { text: 'Persistence', x: vertices.persistence.x + 35, y: vertices.persistence.y + 20, fill: '#00ffaa' },
        { text: 'Practicality', x: vertices.practicality.x, y: vertices.practicality.y - 30, fill: '#ff00ff' }
    ];
    
    labels.forEach(label => {
        const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        text.setAttribute('x', label.x);
        text.setAttribute('y', label.y);
        text.setAttribute('text-anchor', label.text === 'Practicality' ? 'middle' : (label.text === 'Persistence' ? 'start' : 'end'));
        text.setAttribute('fill', label.fill);
        text.setAttribute('font-weight', '700');
        text.setAttribute('font-size', '14');
        text.textContent = label.text;
        svg.appendChild(text);
    });
    
    // Calculate point position
    const total = arch.sovereignty + arch.persistence + arch.practicality;
    const point = total === 0 ? { x: center, y: center } : {
        x: (vertices.sovereignty.x * arch.sovereignty + 
            vertices.persistence.x * arch.persistence + 
            vertices.practicality.x * arch.practicality) / total,
        y: (vertices.sovereignty.y * arch.sovereignty + 
            vertices.persistence.y * arch.persistence + 
            vertices.practicality.y * arch.practicality) / total
    };
    
    // Draw lines to vertices
    const lines = [
        { to: vertices.sovereignty, opacity: arch.sovereignty / 100, color: '#06b6d4' },
        { to: vertices.persistence, opacity: arch.persistence / 100, color: '#10b981' },
        { to: vertices.practicality, opacity: arch.practicality / 100, color: '#a855f7' }
    ];
    
    lines.forEach(line => {
        const lineEl = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        lineEl.setAttribute('x1', point.x);
        lineEl.setAttribute('y1', point.y);
        lineEl.setAttribute('x2', line.to.x);
        lineEl.setAttribute('y2', line.to.y);
        lineEl.setAttribute('stroke', line.color);
        lineEl.setAttribute('stroke-width', '1');
        lineEl.setAttribute('opacity', line.opacity);
        svg.appendChild(lineEl);
    });
    
    // Draw point
    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
    circle.setAttribute('cx', point.x);
    circle.setAttribute('cy', point.y);
    circle.setAttribute('r', '10');
    circle.setAttribute('fill', arch.color || '#3b82f6');
    circle.setAttribute('stroke', '#fff');
    circle.setAttribute('stroke-width', '2');
    svg.appendChild(circle);
}

function updateScores(arch) {
    document.getElementById('sov-score').textContent = arch.sovereignty + '%';
    document.getElementById('per-score').textContent = arch.persistence + '%';
    document.getElementById('pra-score').textContent = arch.practicality + '%';
    
    document.getElementById('sov-bar').style.width = arch.sovereignty + '%';
    document.getElementById('per-bar').style.width = arch.persistence + '%';
    document.getElementById('pra-bar').style.width = arch.practicality + '%';
    
    const total = arch.sovereignty + arch.persistence + arch.practicality;
    document.getElementById('total-score').textContent = total;
}

function updateCustomArch() {
    customArchitecture.sovereignty = parseInt(document.getElementById('sov-slider').value);
    customArchitecture.persistence = parseInt(document.getElementById('per-slider').value);
    customArchitecture.practicality = parseInt(document.getElementById('pra-slider').value);
    
    document.getElementById('custom-sov').textContent = customArchitecture.sovereignty + '%';
    document.getElementById('custom-per').textContent = customArchitecture.persistence + '%';
    document.getElementById('custom-pra').textContent = customArchitecture.practicality + '%';
    
    renderTriangle('custom-triangle-svg', customArchitecture);
    updateCustomTotal();
}

function updateCustomTotal() {
    const total = customArchitecture.sovereignty + customArchitecture.persistence + customArchitecture.practicality;
    document.getElementById('custom-total-value').textContent = total;
    
    const totalDiv = document.getElementById('custom-total');
    const warning = document.getElementById('custom-warning');
    
    if (total > 200) {
        totalDiv.className = 'total-score invalid';
        warning.style.display = 'block';
        document.getElementById('custom-total-value').style.color = '#ff6b6b';
    } else {
        totalDiv.className = 'total-score valid';
        warning.style.display = 'none';
        document.getElementById('custom-total-value').style.color = '#00ffaa';
    }
}

function visualizeCustom() {
    selectedArchitecture = {
        name: 'Custom Architecture',
        ...customArchitecture,
        color: '#3b82f6',
        description: 'Custom trilemma configuration'
    };
    renderArchitectureGrid();
    renderTriangle('triangle-svg', selectedArchitecture);
    updateScores(selectedArchitecture);
    document.getElementById('selected-arch-name').textContent = selectedArchitecture.name;
    document.getElementById('selected-arch-description').textContent = selectedArchitecture.description;
    document.getElementById('trilemma-position').textContent = getTrilemmaPosition(selectedArchitecture);
}

</script>
